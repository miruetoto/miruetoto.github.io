---
layout: post
title: (정리) back fitting 
---

### About this doc 

- 여기에서는 Backfitting에 대한 내용을 다룬다. 본 내용은 

### Back fitting 

- 실제모형이 아래와 같다고 하자. 
\begin{align}
{\bf y}= X_1 \beta_1 + X_2 \beta_2 + {\boldsymbol \epsilon} 
\end{align}
여기에서 $X_1=c(x_{11},\dots,x_{n1})$ 이고 $X_2=c(x_{12},\dots,x_{n2})$라고 하자. 보통 이럴때는 아래와 같이 회귀계수를 구하면 된다. 
\begin{align}
\hat{\boldsymbol\beta}= \left({\bf X}'{\bf X}\right)^{-1}{\bf X}'{\bf y}
\end{align}
여기에서 ${\bf X}=cbind(X_1, X_2)$ 이고, ${\boldsymbol \beta}=rbind(\beta_1,\beta_2)$ 이다. 

- 잘 알겠지만 $\hat{\beta}_ 2$ 을 구하고 싶다면 $\hat{\boldsymbol \beta}$ 에서 두번째 원소를 취하면 된다. 강의노트에서는 $\hat{\beta_2 }$ 와 아래의 방법으로 구한 $\tilde{\beta}_ 2$ 가 같음을 증명하였다. <br/><br/>
**(1)** ${\bf y}$ 를 $X_1$ 로 적합함. 그리고 잔차를 ${\bf e}_ {{\bf y} | X_1}$ 이라 정의함. <br/>
**(2)** $X_2$ 를 $X_1$ 로 적합함. 그리고 잔차를 ${\bf e}_ {X_2 | X_1}$ 이라 정의함. <br/>
**(3)** (1) 의 잔차를 (2) 의 잔차로 적합함. 즉
\begin{align}
{\bf e}_ {{\bf y} | X_1} \sim {\bf e}_ {X_2 | X_1}
\end{align}
을 수행함. 그리고 리그레션에서 ${\bf e}_ {X_2 | X_1}$ 에 대응하는 변수를 $\tilde \beta_2$라고 함. 

- **(proof)** 먼저 아래를 보이자. 
\begin{align}
X_1' {\bf e}_ {X_2 | X_1}  = X_1'({\bf I}- X_1(X_1'X_1)^{-1}X_1')X_2 = X_1'X_2-X_1'X_2 =  {\bf 0}
\end{align}
**따라서 $X_1$과 ${\bf e}_ {X_2 | X_1}$은 서로 직교한다. ** 
\begin{align}
\tilde{\beta}_ 2 =  \left({\bf e}_ {X_2 | X_1}'  {\bf e}_ {X_2 | X_1}\right)^{-1} {\bf e}_ {X_2 | X_1}' {\bf e}_ {{\bf y} | X_1}
\end{align}
이다. 

- 이제 증명을 하여보자. 
\begin{align}
\tilde{\beta}_ 2 =  \left({\bf e}_ {X_2 | X_1}'  {\bf e}_ {X_2 | X_1}\right)^{-1} {\bf e}_ {X_2 | X_1}' {\bf e}_ {{\bf y} | X_1}
\end{align}
이다. 따라서 
\begin{align}
\tilde{\beta}_ 2 =  \left((X_2-H_1X_1)'(X_2-H_1X_1)\right)^{-1} (X_2-H_1X_1)'(y-H_1y)
\end{align}
