--- 
layout: post
title: (정리) 확률론, Intergration 
--- 

### About this Doc

- 여기에서는 듀렛책 챕터 1.4~1.7의 내용을 다룬다. 이곳에서는 메저러블 맵핑 $f$의 적분을 다룬다. 

### Measure Theory : Integration 

- $f:\Omega \rightarrow \mathbb{R}$가 두 가측공간 $(\Omega,{\cal F})$와 $(\mathbb{R},{\cal R})$를 이어주는 매저러블-맵핑이라고 하자. 그리고 $\mu:{\cal F} \rightarrow \mathbb{R}$는 ${\cal F}$에서의 메저라고 하자. 여기에서 특별히 $\mu$는 **$\sigma$-finite measure** 라고 정의한다(사실 우리가 관심 있는것은 $f=X$이며 $\mu=P$인 경우이지만 일단 일반적은 측도론에서 이야기 하도록 하자). 이 챕터에서 우리의 관심은 (1) 메저러블-맵핑 $f$를 메저$\mu$로 적분한것 즉 
\begin{align}
\int f d \mu
\end{align}
를 ***잘*** 정의하고 (2) 적분관련 성질들을 자유자재로 계산할 수 있는 ***적당한 조건***을 알아보는 것이다. 여기에서 적분관련 성질들은 예를들어 
\begin{align}
\int af d\mu = a \int f d \mu 
\end{align} 
\begin{align}
\int f+g d\mu = \int f d \mu + \int g d \mu 
\end{align} 
와 같은 것들을 의미한다. 

- 여기서 잠깐 정리해둘 노테이션이 있는데 메저러블-맵핑 $f$와 메저 $\mu$에 대하여 
\begin{align}
\int f d \mu
\end{align}
와 
\begin{align}
\int f(x) \mu(dx)
\end{align}
는 같은 기호이다. (Chung 책 p.42를 참고하면 알 수 있음) 

- 다시 본론으로 돌아오자. $\int f d \mu$를 정의하기 위해 필요한 기본가정을 살펴보자. 당연히 $\int f d \mu$를 계산하기 위해서는 보는것처럼 매저러블 맵핑 $f$가 정의되어야 하며, 메져 $\mu$가 정의되어야 한다. 그리고 $f$와 $\mu$를 정의하기 위한 시그마필드 $\cal F$가 정의되어야 한다. 참고로 메저러블 맵핑 $f$를 정의하기 위해서는 기본적으로 $(\Omega,{\cal F}),~ (\mathbb{R},{\cal R})$이 모두 필요하지만 편의상 ${\cal F}$만 필요하다고 생각해도 무방하다는 것을 앞에서 설명하였다. 그리고 주목할만한 점이 하나 있는데 $f$와 $\mu$는 같은 시그마필드 ${\cal F}$에서 정의되고 있다는 것이다. 이것은 우리가 지금 정의하고 싶은 적분이 고등학교때 배운 적분처럼 실수축위에서 이루어지고 있는 것이 아니라 $(\Omega,{\cal F})$에서 이루어 지고 있다는 것을 생각하면 쉽게 이해할 수 있다. 그리고 또 하나 필요한 가정은 $\mu$가 **$\sigma$-finite measure** 라는 것이다. 이걸 이용하면 임의의 $A \in {\cal F}$에 대하여서도 $\mu(A)<\infty$가 성립하게 되어서 $d \mu$부분을 상당히 안정적으로 정의할 수 있다. 요약하면 
\begin{align}
\int f d \mu
\end{align}
를 정의하기 위해서는 1) $f$가 ${\cal F}$에 대한 메저러블펑션이며 2) $\mu$가 ${\cal F}$에 대한 **$\sigma$-finite measure**이어야 한다(그리고 $f$와 $\mu$는 같은 시그마필드 ${\cal F}$를 공유해야함). 

- 왜 적분을 **measure theory** 를 이용하여 정의할까? 고등학교때 정의하던대로 하면 안되나? 다 이유가 있어서 이렇게 정의하는 것이다. **measure theory** 를 이용하여 적분을 정의하면 고등학교때 배운 논리로 정의하기 애매하 적분들을 매우 깔끔하게 정의할 수 있다는 장점이 있다. 가령 예를들면 모든 유리수에서 $1$의 값을 가지고 나머지는 $0$을 가지는 함수 $f$를 생각하여 보자. 즉 $f$는 아래와 같다. 
\begin{align}
f(x)=\begin{cases} 1 & x \in \mathbb{Q} \\\\ 0 & x \notin \mathbb{Q} \end{cases}
\end{align}
이 함수 $f$에 대한 적분은 고등학교때 배운 **구분구적법** 혹은 **리만적분** 과 같은 방식으로는 정의할 수 없다(얼핏 생각하면 **리만적분**으로는 가능할것 같은데 불가능하다고 한다 $f$를 리만적분하면 0과 1사이의 임의의 값이 랜덤으로 정의된다고 한다). 하지만 **measure theory**를 이용하면 이 적분값은 0으로 깔끔하게 정의된다. 즉 
\begin{align}
\int f d\lambda=0
\end{align}
으로 깔끔하게 정의된다. 여기에서 $\lambda$는 르벡메져이며 이러한 적분을 **르벡적분**이라고 한다. 기본적으로 **구분구적법** 이나 **리만적분** 은 $f$가 연속이거나 부분적으로 연속이어야 할 것 같은 느낌인데 **measure theory**를 이용한 **르벡적분** 은 $f$가 매저러블 맵핑이기만 하면 되므로 좀 더 적분을 정의할 수 있는 함수의 선택폭이 넓다. 일단 ${\cal R}$자체가 거의 대부분의 ''subset of $\mathbb{R}$''을 커버하고 있기 때문에 ${\cal R}$-메저러블하지 않는 함수 $f:\mathbb{R} \rightarrow \mathbb{R}$는 거의 없다고 보는 편이 좋다. 즉 **르벡적분** 불가능한 함수 $f:\mathbb{R} \rightarrow \mathbb{R}$는 거의 없다고 보는것이 맞다(뭐 칸토르집합에서만 1의 값을 가지고 그렇지 않은 경우에서는 0의 값을 가지는 이상한 함수 $f$만 아니라며 말이다).

- 이제 메저러블-맵핑 $f$의 적분을 **모순없이** 정의하는 방법을 살펴보자. 적분은 기본적으로 넓이를 구하는 개념이므로 $f:\Omega \rightarrow \mathbb{R}$가 **simple function** 일때  $\mu:{\cal F} \rightarrow \mathbb{R}$에 대한 적분은 사각형넓이의 유한합으로 매우 명확히 정의할 수 있다. 여기까지는 당연한거라서 우리의 관심은 <br/><br/>
''$f$가 simple function이 아닐 경우에도 $\mu$에 대한 적분을 모순없이 잘 정의할 수 있을까?''
<br/><br/>
가 된다. 결론적으로 (1) $f$가 **bounded function** 인 경우 (2) $f$가 **non-negative function**인 경우 (3) $\int |f| d\mu < \infty$인 경우에서는 적분값 
\begin{align}
\int f d \mu 
\end{align}
가 (마치 $f$가 **simple function**인것마냥) **모순없이** 잘 정의되며 $\int af d\mu = a \int f d \mu$, $\int f+g d\mu = \int f d \mu + \int g d \mu$ 따위의 성질들도 **모순없이** 잘 성립한다. 

- 먼저 (1) $f$가 **bounded function** 인 경우를 살펴보자. $f$를 두 **simple function** $\phi$, $\psi$ 사이에 끼워넣고, 즉 $\phi \leq f \leq \psi$ 와 같이 만든 다음 $\int f d\mu $를 아래와 같이 정의하면 $f$가 **simple function** 일때마냥 $\mu$에 대한 적분값을 잘 정의할 수 있다. 
\begin{align}
\int f d\mu = \sup_{\phi \leq f} \int \phi d\mu = \inf_{\psi \geq f} \int \psi d\mu. 
\end{align}
참고로 위의 정의가 말이 되려면 즉 **모순이 되지 않으려면** $\sup_{\phi \leq f} \int \phi d\mu = \inf_{\psi \geq f} \int \psi d\mu$가 성립해야 하는데 이것이 성립하는 것은 듀렛책에 증명이 되어있다. 

- 위의 결과를 이용하면 (2) $f$가 **non-negative function**인 경우에도 $\mu$에 대한 적분을 쉽게 정의할 수 있다. 먼저 $h$를 $0\leq h \leq f$를 만족하는 **bounded function**이라고 하자. $\int f d\mu$는 아래와 같이 $\int h d \mu$의 sup으로 정의할 수 있다. 
\begin{align}
\int f d\mu = \sup_{0\leq h \leq f} \int h d \mu
\end{align}

- 이제 (3)의 경우를 살펴보자. 일반적인 $f$는 아래와 같이 표현가능하다. 
\begin{align}
f=f^+ -f^-
\end{align}
따라서 $\int f d\mu$는 아래와 같이 정의할 수 있다. 
\begin{align}
\int f d\mu = \int f^+ d\mu - \int f^- d\mu
\end{align}
단지 위의 식이 **모순없이** 정의되려면 $\int f^+ d\mu$와 $\int f^- d\mu$이 모두 무한대이면 안되는데 이런 경우는 $\int |f| d\mu < \infty$라는 조건에 의해서 방지된다. 참고로 $\int |f| d\mu < \infty$를 만족하는 $f$를 우리는 **integrable하다**고 한다. 

- $(\Omega, {\cal F},\mu)=(\mathbb{R}, {\cal R}, \mu)$이고 적분을 하는 메져 $\mu$가 $\mu((a,b])=F(b)-F(a)$와 같은 꼴로 표현가능하다면 우리는 $\int f d\lambda$를 아래와 같이 쓸 수 있다. 
\begin{align}
\int f d\mu = \int f(x) dF(x)
\end{align}
예를들어 $(\Omega, {\cal F},\mu)=(\mathbb{R}, {\cal R}, \lambda)$와 같은 상황을 생각해보자. 여기에서는 적분을 수행하는 메져가 르벡메져이고 르벡메져 $\lambda$는 $\lambda((a,b])=b-a$꼴로 쓸 수 있으므로 
\begin{align}
\int f d\lambda = \int f(x) dx
\end{align}
와 같이 나타낼 수 있다. 

- $\Omega$가 countable set이고 ${\cal F}$는 ''all subset of $\Omega$'' 라고 하자. $\mu$는 counting measure라고 하자. 이때는 $\int f d\mu$는 아래와 같이 나타낼 수 있다. 
\begin{align}
\int f d \mu = \sum_{i \in \Omega} f(i).
\end{align}

- $f$가 메저러블 맵핑이고 $\\{f_n\\}$이 sequence of measurable mapping 이라고 하자. 이제 $f_n \rightarrow f$ **a.s.** 일 경우 극한이 적분안으로 들어오는 조건 즉 아래의 식이 만족하는 조건을 찾는 것에 관심을 가져보자. 
\begin{align}
\lim_{n \rightarrow \infty} \int f_n d\mu = \int \left( \lim_{n \rightarrow \infty} f_n \right) d\mu = \int f d\mu
\end{align}
결론적으로 말해서 (1) $f_n$이 모두 **bounded function**이거나 (2) $f_n$이 모두 **non-negative function**이거나 (3) $f_n$이 모두 **integrable**하면 된다. 신기하게도 모든 $n$에 대하여 $\int f_n d \mu$를 **모순없이** 정의할 수 있기만 하면 되는 느낌이다. 심지어 (3)의 조건은 (1)의 조건을 포함하므로 결론적으로 극한이 적분안으로 들어오기 위해서는 1) $f_n$이 모두 **non-negative function**이거나 2) $f_n$이 모두 **integrable** 하면 된다는 것을 알 수 있다.
- 위의 과정에서 (1)의 경우를 정리한 것이 BCT이며 (2)의 경우을 정리한것이 MCT이고 (3)의 경우를 정리한것이 DCT이다. 
증명은 당연히 BCT $\rightarrow$ MCT $\rightarrow$ DCT 순서로 하며 MCT는 BCT로부터 바로 증명할 수 없어서 Fatou lemma를 추가적으로 증명한다. 각 정리들의 정확하게 써보자. 참고로 책마다 BCT, MCT, DCT, Fatou lemma가 성립하기 위한 조건들이 조금씩 다르다. 여러책을 살펴본 결과 Chung 3판 p.48에서 정리한것을 외우는 것이 정신건강에 좋다고 생각하였다. 정리한 것을 요약하여보자. 우선 (1) sequence of msrable mapping $\\{f_n\\}$와 관련된 수렴은 모두 **a.s.** 수렴을 가정한다. 즉 BCT, DCT 에서는 $f_n \rightarrow f$ **a.s.** 를 가정하고 MCT에서는 $f_n \uparrow f$ **a.s.** 를 가정한다. 그리고 (2) sequence of msrable mapping $\\{f_n\\}$과 관련된 bound 역시 모두 **a.e.** 를 가정한다. 즉 MCT나 Fatou lemma에서 $f_n \geq 0$ **a.e.** 이며, BCT에서는 $f_n \leq M$ **a.e.** 를 가정한다. 

- 참고로 BCT의 경우 $f_n \rightarrow f$ **in measure $\mu$** 인 경우에도 성립함이 듀렛책 4판 p.25에 증명되어 있다. 증명은 그렇게 어려운 편이 아니니 관심이 있으면 참고하길 바란다. 

- 파토우 레마는 아래와 같다. 
\begin{align}
\liminf_{n \rightarrow \infty} \int f_n d\mu \geq \int \left(\liminf_{n\rightarrow \infty} f_n \right) d\mu 
\end{align}
여기에서 $f_n \geq 0$ **a.e.** 이다. 생각보다 안외워지므로 자주 보길 바란다. 

- **(듀렛책 4판 p.29, Thm 1.6.8)** $X_n \rightarrow X$ **a.s.** 이고 $h$가 **(bounded 비슷한) 적당한 조건**을 만족하는 **연속함수**일경우 
\begin{align}
Eh(X_n) \rightarrow Eh(X)
\end{align}
가 성립한다. 여기에서 $h$는 **random variable** $X$의 **image** 에서 그 값이 **적당하게 bound 되어 있는 연속함수**인 느낌이다. 함수 $h$에 대한 조건을 좀 더 명확하게 정의하기 위해서 듀렛책에서는 어떤 보조함수 $g$를 도입하여 두 연속함수 $g,h$가 아래의 조건을 만족한다고 가정하였다. <br/><br/>
  (1) $g \geq 0$ and $g(x) \rightarrow \infty$ as $|x| \rightarrow \infty$ <br/><br/>
  (2) $|h(x)|/g(x) \rightarrow 0$ as $|x| \rightarrow \infty$ <br/><br/>
  (3) $Eg(X_n) \leq K < \infty$ for all $n$. <br/><br/>
(1)과 (3)은 이러한 보조함수 $g(x)$의 성질들을 의미하는데 $g(x)$는 $|x|$가 무한대로 갈때 발산하지만 $E(g(X_n))$의 값은 유한한 즉 **random varialbe** $X$의 **image** 에서는 그 값이 상당히 안정되어 있는 느낌을 준다. 즉 $g$는 전체적으로는 bound 되어있지 않지만 중요한 부분, 즉 $X$의 image에서는 적당히 bound 되어있는 함수라고 해석할 수 있다. 이런 결과와 (2) 를 종합하여 보면 $h$역시 $g$처럼 전체적으로는 bound 되어있지 않지만 중요한 부분 즉 $X$의 image에서는 적당히 bound 되어있는 함수라고 해석 할 수 있다.  

- **(듀렛책 4판 P.30, Thm 1.6.9)** $X$를 $(\Omega, {\cal F})$와 $(S,{\cal S})$를 이어주는 메저러블-맵핑이라고 하자. $X$는 random variable일수도 있고, random vector 일수도 있다. 만약에 $X$가 random vector라면 $(S,{\cal S})=(\mathbb{R}^2,{\cal R}^2)$가 된다. 이제 $X$가 아니라 function of $X$에 관심을 가져보자. 함수 $f$를 $(S,{\cal S})$와 $(\mathbb{R},{\cal R})$를 이어주는 메저러블-맵핑이라고 하면 $f$는 function of $X$가 되며 $f(X)$역시 메저러블-맵핑이 된다.(즉 $f(X)$역시 확률변수가 된다는 의미임) 만약에 $X$의 평균이 아니라 function of $X$의 평균, 즉 $f(X)$의 평균을 계산하고 싶다면 어떻게 해야하는가? 이런 경우는 매우 흔한데 대표적으로 $X$의 분산을 계산하고 싶은 경우도 이에 해당한다. 듀렛책에서는 $f(X)$가 양수이거나 적분가능할때 (즉 $f \geq 0$ 이거나 $E|f(X)|< \infty$일때) 아래와 같이 $f(X)$의 평균을 계산할 수 있다고 제시한다. 
\begin{align}
Ef(X)=\int_{S} f(y)\mu(dy)
\end{align}
여기에서 $\mu$는 $X$의 **distribution function** 이다. 즉 $\mu(A) = P(X \in A)$가 성립한다. $\mu(dy)$의 의미가 먼지 모르겠음......... 

- 두개의 메저러블 맵핑 $X_1$과 $X_2$를 각각 $(\Omega_1,{\cal F}_ 1, P_1)$와 $(\Omega_2,{\cal F}_ 2, P_2)$에서 정의하자. 확률벡터 $(X_1,X_2)$를 정의하기 위한 공간을 construct하자. 먼저 
\begin{align}
\Omega=\Omega_1 \times \Omega_2= \\{(x_1,x_2):x_1 \in \Omega_1, x_2 \in \Omega_2\\}
\end{align}
와 같이 설정하자. 그리고 ${\cal S}$를 아래와 같이 정의하자. 
\begin{align}
{\cal S}=\\{A\times B: A \in {\cal F}_ 1, B \in {\cal F}_ 2\\}
\end{align}
이때 ${\cal S}$는 semi-algebra가 된다고 한다. ${\cal F}$를 아래와 같이 정의한다. 
\begin{align}
{\cal F}=\sigma({\cal S})
\end{align}
이제 공간 $(\Omega,{\cal F})$는 확률벡터 $(X_1,X_2)$가 정의 될 수 있는 공간이 되었다. 즉 확률벡터 $(X_1,X_2)$는 $(\Omega,{\cal F})$에서의 메저러블-맵핑이 된다. 이제 확률벡터 $(X_1,X_2)$의 분포를 결정할 수 있는 메져 $P$만 정의하면 된다. 일반적인 길이의 개념을 넓이로 확장시키면 메져 $P$가 아래의 성질을 만족하는 것이 합리적이라고 생각된다. 
\begin{align}
P(A \times B)=P_1(A) \times P_2(B)
\end{align}
듀렛책의 thm 1.7.1에 의하면 이러한 메져 $P$가 유니크하게 존재한다고 한다. 

***useful inequalities***
- 여기에서는 적분 혹은 평균과 관련된 유용한 부등식들을 정리하였다. 
- Jensen's inequality: 젠센스-인이퀄리티는 임의의 convex 함수 $\phi$에 대하여 아래가 성립한다는 것인데 
\begin{align}
\phi \left( \int f d\mu \right) \leq \int \phi (f) d \mu
\end{align}
이것을 적용한 대표적인 예제는 확률변수 $X$에 대하여 $E^2(X) \leq E(X^2)$이 성립하는 것이다. 

- Holder's inequality: 횔더스-인이퀼리티를 정의하기 위해서는 $$\\| f \\|_p$를 정의해야 한다.  

- Minkowski's inequality: 민코우스키-인이퀄리티는 

- Chebyshev's inequality: 쳬비쉐프-인이퀄리티는 

- Markov's inequality: 마코브-인이퀄리티는 
