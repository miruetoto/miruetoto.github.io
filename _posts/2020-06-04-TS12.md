---
layout : post 
title : (강의) 시계열 12주차 강의 스크립트
---

### 스크립트

- 12주차 강의 소멸분에 대한 재촬영임. 

- 수통강의도 하고 있는데, 수통강의중에 배터리부족으로 아이패드 꺼짐. 

- 녹음을 설정에서 오디오녹음 가능하도록 설정해두고 계속 쓰고있었는데 아이패드가 껐다 켜지면서 설정이 초기화된듯. 

- 수통강의와 시계열강의모두 오디오없이 녹음하게됨. 

- 아무튼 강의시작함. 

- 저번시간에 비정상시계열이 가지는 추세를 4가지 로 소개함. 

- 참고로 이 시계열들은 모두 분산이 (1) 처음부터 일정했거나 (2) 적절한 변환을 통하여 일정해진 상태라 가정함. 

- 추세는 크게 계절과 비계절 추세로 나눌수도 있고 확률적추세와 비확률적 추세로 나눌수도 있음. 그래서 4개의 카테고리 생김. 

- 계절적 추세와 비 계절적 추세는 눈으로 쉽게 구분가능함. 즉 계절성이 있는지 없는지는 쉽게 판단가능. 

- 사전지식으로도 판단가능. 예를들어 월별 백화점 매출같은 경우는 데이터 안그려봐도 계절성 있을것으로 예측할 수 있음. 

- 그래서 계절적 추세와 비계절적 추세를 판단하는 것은 상대적으로 쉬움. 

- 확률적 추세와 결정적 추세를 파악하는건 어려움. 

- 우선 비 계절성의 경우를 살펴보자. 논의를 단순화 하기 위해서 랜덤워크 vs 단순회귀모형을 판단하자. 

- 각각의 그림은 아마 이런 형태로 나올것이다. (표의 오른쪽)

- 그림으로 판단하는 것은 감각에 의존함. 이거보다 좀더 괜찮은 방법은 SACF를 찍어보는 것임. 랜덤워크라면 SACF가 서서히 감소할것임. 

- 예를들면 SACF는 이럴것임. (ACF를 그린다.)

- 일단 이 강의에서는 랜덤워크의 그림이 이런느낌으로 된다라는것 자체와 ACF의 모양을 기억하는게 더 중요함. 그래서 우선 이 그림모양을 잘 기억하자. 

- 1,2를 구분하였다면 적당한 과정을 통하여 정상시계열로 만든뒤 분석하면 됨. 예를들어 1번 경우라면 결정적추세를 적당한 방법을 통하여 제거하고(예를들면 리그레션을 한다든가?) 2번이라면 차분을 하면됨. 

- 사실 이부분은 좀더 토론이 필요한 내용임. 이건 나중에 따로 설명하겠음. 


--- 

- 이제 3,4를 한번 살펴보자. 

- 3의 예제는 일별기온일 것임. 일별기온은 주기가 365일 것임. 계절에 따른 기온의 주기성은 결정적이라 볼 수 있으므로 모형은 $y_t=s_t+\epsilon_t$의 느낌일듯. 

- 4는 어떤 경우일까? 

- 데이터를 이렇게 관측하였다고 하자. 

- 이건 주기가 4인 시계열을 형상할 것이라 예측됨. 

- 왜 주기가 4일까? 

- $z_1,z_5,\dots,$는 하나의 랜덤워크일것임. 모양을 단순화 시켜 이러하다라고 하자. 

- 나머지도 마찬가지일것임. 

- 느낌을 살려보기 위해 1,2,3,4 4명의 사람이 있고 각각 서로 다른 4개의 시계열을 관측했다고 하자. 각각은 모두 랜덤워크를 관측할 것임. 

- 편의상 1,2,3번 사람이 관측한 랜덤워크는 우상향한다고 하자. 4번사람이 관측한 랜덤워크는 우하향한다고 하자. 

- 점을 찍으며 표현. 

- 실제 시계열은 1,2,3,4번 사람들이 관측한 것을 종합하면 나올것인데 아마 이런그림일것임. 

- 점으로만 찍혀있어서 느낌이 안살텐데 점들을 이은그림을 그려보면 (이런그림을 닷커넥티드 플랏이라고 함) 주기가 4가될것임. 

- 실제그림을 그려보자. (내가 R로 미리그려둠)

--- 

### R의 첫번째그림 

- 그림을 보여주며.. 이런느낌임. 

- 자.. 코드를 잘봐. 내가 시계열 4개 그렸나? 1개그렸음. 그런데 이거 마치 4개의 시계열을 관측한것처럼 그림 그려짐. 

- 이게 dot-connected가 아니라서 그럼. 만약에 각 시점을 이은 dot-connect를 그리면 다른느낌일것임. 

- 그려보자. 

### R의 두번째그림 

- 첫그림와 느낌이 많이 다른건 알겠음. (첫그림은 4개의 시계열이 있어보이는데 여기는 그렇지는 않으니까)

- 그런데 그렇다고 해서 주기성이 잘 보이는건 아님

- 너무 빽빽해서 그러함. 

- 1:200정도까지만 그려보자. 

### R의 세번째그림 

- 주기성 잘보임

- 예상한 결과임 

### R의 네번째그림 

- 이건 세번째 그림에서 1,5,9를 빨간색으로 표현하고 나머지도 각각 다른색으로 표현한거임. 

- 빨강만 보면 우상향 랜덤워크

- 초록만 보면 우상향 랜덤워크

- 나머지 2개는 우하향 랜덤워크처럼 보임

- 이러한 랜덤워크들이 서로 어우러져 주기가 있듯한 그림이 만들어짐. 

### 다시 돌아와서 

--- 

- 주기가 있어보이면 어찌해야하나? 

- 그냥 시계열을 4개로 쪼갠다음에 각각 1회씩 차분하고 다시 합치면 되지 않나? 

- 그걸 식으로 쓰면 $Z_t-Z_{t-4}$를 수행하고 그 결과를 $W_t$로 쓴다음에 $W_t$를 분석한다는 말임.

- 이걸 계절차분이라고 말함. 

- 차분을 하는것이 $Z_t$에 오퍼레이터 $(1-B)$를 곱한것이라 해석한다면 계절차분은 오퍼레티어 $(1-B^4)$를 곱한것이라 해석가능. 

- 계절차분을 수행하면 표에서 보는것 처럼 4개의 값이 물음표로 변함. (그냥 차분은 1개의 값만 소실됨.)

--- 

- 그래 계절차분하자는 건 알겠음.

- 주기4로 계절차분할건지 어케암? 

- 그림보고 주기3인지 주기4인지 판단가능하냐? 

- 모른다. 하지만 SACF를 찍어보면 안다.

- 자 다시 랜덤워크랑 비교해보자? 

- 그림은 일단 이러하다. 

- 랜덤워크의 ACF는 이러하다. 

- $Z_t=Z_{t-4}+\epsilon_t$의 ACF는 이러한 모양된다. 왜???

- Lag=0일때는 이해가 쉽다. 

- 이모형에서 Lag=4일때는 랜덤워크에서 Lag=1일때와 같을 것이다. (식을 보면 그렇자나?)

- 동등한 논리로 이 모형에서 Lag=8은 랜덤워크에서 Lag=2일때와 같다. 

- 그래서 이런모양이 된다. 

- Lag=1,2,3일떄는 물음표해놓았는데.. 이거는 알필요없다. 안중요하다. 이런의미가 아니라 진짜 모른다는 의미이다. 

- 뭐가 나올지 모른다. 

- 무슨말인지 알아보기 위해서 R로 다시 돌아가자. 

### 첫 ACF

- 이건 아까 그 예제에서 SACF를 찍어본건데 이와 같이 나왔다.

- Lag=1에서 약 -0.3 Lag=2에서 약 +0.3 Lag=3에서 약 -0.3이 나온것같다. 

- 그럼 대충 느낌인가? 강약약약 강? 부호는바뀌면서? 

- 아니다. 

- 서로다른 10개의 평행세계에서 각각 동일한 모형을 발생시키고 SACF를 관찰해보자. 

- 그림이 다 다르다. 

- Lag=1,2,3에서는 머가 나올지 모름. 

- 왜그럴까? 

- 만약에 첫번째 사람이 관측한 랜덤워크가 우상향하고 두번째사람이 관측한 랜덤워크가 우상향하면 첫번째 랜덤워크와 두번째 랜덤워크가 비슷해보일것이니까 Lag=1에서는 큰 양의값을 가짐. 

- 만약에 첫번째 랜덤워크가 우상향하고 두번째 랜덤워크가 크게 우하향하면 Lag=1에서는 큰 음의 값을 가짐. 

- 첫번째 랜덤워크가 우상향 세번째 랜덤워크가 적당히 우상향하면 lag=2에서 0.5정도의 값을 가질수도? 

- 이런식으로 생각을 확장하면 Lag=1,2,3의 값은 그냥 운에 따라 좌우된다는것을 알 수 있음.

- 그래도 모든 평행세계 다 관측해보면 평균적으로는 다 0일듯. 

- 하지만 확실한건 Lag=4마다 거의 1에 가까운 양의 값이 주기적으로 나온다는것임. 

- 이걸가지고 주기가 4로 계절차분하자고 주장가능함. 

### 다시돌아와서 

- 잠깐 이야기가 길어졌는데, 주기4인거 어떻게 알거냐는 질문에 대한 대답을 위해서 이런이야기를 함. 

- 계절차분하려면 주기를 알아야하는데 그 근거로 SACF를 그러보면된다는게 결론임. 

- 랜덤워크가 아니더라도 주기4가 나올까? 

- 이런모형생각해보자. 

- 네명이 AR(1)모형을 관측한 꼴일텐데

- 우선 AR(1)모형의 ACF는 이런모양

- 그러면 위와 같은 논리로 오른쪽 모형의 ACF는 이럴것임을 쉽게 추측가능. 

- 나머지는? 

- 한번 R로 그려보자. 

### 평행세계들 그림. 

- Lag=4,8,12.. 빼고 절삭. 

- 이론적으로 따져볼까? 

### 다시 돌아와서

- 얼핏보면 AR(4) 모형 

- Lag=1에서 ACF는 표를 그리면서 이렇게 따질수 있음. 

- 0이다.. 

- Lag=2,3에서도 동일한 논리. 

- Lag=4에서만 값이 나옴. 

