---
layout : post 
title : (정리) 중심극한정리 
---

### About this doc

- 이번에는 중심극한 정리를 정리한다. 

- 김우철교수님 교재의 내용을 바탕으로 한다. 따라서 수리통계 수준이다. 


### 정리 5.5.1 

- 확률변수 $X_1,\dots,X_n$이 서로 독립이고 동일한 분포를 따른다고 하자. 그리고 $V(X_1)$이 양의실수라고 하자. 또한 $EX_1=\mu$, $VX_1=\sigma^2$ 이라고 하자. 

- 이 조건은 생각보다 강한조건들이다. 우선 (1) ***iid***가정을 사용하였고 (2) 분산이 유한함을 가정하였다. 

- 교재에서는 증명의 편의성을 위해서 (3) $X_1$의 *mgf*가 존재한다고 가정하였다. 참고로 *mgf*가 존재하려면 모든 모멘트가 유한하여야 하므로 (3)의 조건은 (2)의 조건을 포함한다. 

- 분산이 유한함을 가정하는것도 엄청난 조건인데 *mgf*가 존재한다는 조건은 더 엄청난 조건이다. 따라서 수리통계에서 얼마나 강한가정하에서 중심극한 정리를 증명했는지 보여준다. 

- 아무튼 이러한 조건에서 아래가 성립한다. 
\begin{align}
\lim_{n\to\infty}P\Bigg(\frac{\bar X-\mu}{\sigma/\sqrt{n} }\leq x\Bigg)=P(Z\leq x)
\end{align}
위의 조건을 간략하게 아래와 같이 표현하기도 한다. 
\begin{align}
\frac{\bar X-\mu}{\sigma/\sqrt{n} } \overset{d}{\to} Z, \quad Z\sim N(0,1)
\end{align}
그리고 $\frac{\bar X-\mu}{\sigma/\sqrt{n} }$가 표준정규분포를 따르는 확률변수 $Z$로 분포수렴한다고 한다. 

- 이때 위에서 $\frac{\bar X-\mu}{\sigma/\sqrt{n} }$를 정리하여 아래와 같이 표현하기도 한다. 
\begin{align}
\frac{\bar X-\mu}{\sigma/\sqrt{n} }= \frac{\sqrt{n}(\bar{X}-\mu)}{\sigma }
\end{align}

- 증명은 그렇게 어렵지 않다. 우선 김우철 교수님의 교재 p.208의 64)의 내용이 무엇인지 살펴보자. 아래와 같이 되어있다.
> 일반적으로 $Z$의 누적분포함수가 연속함수일 때 다음이 성립한다. 
\begin{align}
\lim_{n \to \infty}mgf_{Z_n}(t)=mgf_Z(t) ~ \forall t: \|t\|<h ~ (\exists h>0) \quad \Longrightarrow \quad \lim_{n\to\infty}P(Z_n\leq x)=P(Z\leq x) \forall x
\end{align}


- 위의 말은 결국 분포수렴임을 보이려면 원래 *cdf*가 수렴함을 보여야하는데 극한분포가 연속일경우 (예를들면 표준정규분포 같은) *mgf*가 수렴함을 보이면 충분하다는 의미이다. 따라서 결국 우리는 $\frac{\sqrt{n}(\bar{X}-\mu)}{\sigma^2}$의 *mgf*가 $n \to \infty$일때 $e^{t^2/2}$로 수렴함을 보이면 된다. 즉 
\begin{align}
\lim_{n\to \infty} mgf_{\sqrt{n}(\bar{X}-\mu)/\sigma }(t) = e^{t^2/2}
\end{align}
임을 보이면 된다. 

- *mgf*의 정의에 의해서 바로 아래를 관찰할 수 있다. 
\begin{align}
mgf_{\sqrt{n}(\bar{X}-\mu)/\sigma }(t)=\big(mgf_{(X_1-\mu)/\sigma}(t/\sqrt{n})\big)^n
\end{align}
이는 다음의 사실들을 상기하면 쉽게 위의 식이 성립함을 알수있다. (연습장) <br/><br/>
**(1)** $mgf_{cX}(t)=mgf_X(t/c)$. <br/>
**(2)** $X_1,\dots,X_n$은 ***iid.***

- $mgf_{(X_1-\mu)/\sigma}(t/\sqrt{n})$를 테일러 전개하자. 함수이름이 너무 기니까 $m(\cdot):=mgf_{(X_1-\mu)/\sigma}(\cdot)$이라고 정의하자. $m(x)$를 $x=0$에서 테일러 전개하면 
\begin{align}
m(x)=m(0)+(x-0)m^{(1)}(0)+\frac{(x-0)^2}{2!}m^{(2)}(0)+\dots
\end{align}
와 같이 된다. 여기에서 $\dots$는 나머지텀이라고 부르는데 $x\to 0$ 일 수록 0에 가까워지는 항목이다. 사실 $m(0)$을 제외한 모든 항목은 $x\to0$ 일수록 0에 가까워진다. 편의상 $m(0)$을 0차-미분항, $(x-0)m^{(1)}(0)$을 1차-미분항, $\frac{(x-0)^2}{2!}m^{(2)}(0)$를 2차-미분항으로 부르기로 하자. 따라서 나머지텀은 3차-미분항, 4차-미분항... 등을 포함하는 항목인데 편의상 이를 뭉뚱그려서 3차이상의 고차미분항으로 부르자. 

- 0차-미분항을 제외하고 나머지는 모두 $x\to 0$일때 $0$으로 가까워진다. 그리고 이론적으로 고차항일수록 $x\to 0$ 일때 더욱 더 빠르게 가까워진다. 예를들어서 
\begin{align}
(x-0)m^{(1)}(0)
\end{align}
보다 
\begin{align}
\frac{(x-0)^2}{2!}m^{(2)}(0)
\end{align}
이 더욱 빠르게 가까워진다. 그 이유는 그렇게 자명하진 않다. 기본적으로 <br/><br/>
(1) $(x-0)$보다 $\frac{(x-0)^2}{2!}$이 더욱 빠르게 $0$으로 수렴 <br/><br/>
함은 자명하지만, <br/><br/>
(2) $(x-0)m^{(1)}(0)$보다 $\frac{(x-0)^2}{2!}m^{(2)}(0)$이 더욱 빠르게 $0$으로 수렴 <br/><br/>
함은 자명하지 않다. 예를들어 $m^{(2)}(0)$등이 값자기 무한대가 되어버릴수도 있기 때문이다. 따라서 테일러 전개가 가능하려면 $m(x)$를 $x=0$에서 반복적으로 미분하였을때 미분값이 갑자기 무한대로 터지는 경우는 제외해야 한다. 이를 수학적으로는 **"$m(x)$가 $x=a$에서 무한번 미분가능하다면 $m(x)$를 $x=a$에서 테일러전개할수 있다"** 라고 표현한다. (우리의 예제는 $a=0$인 경우이다.)

- 결론적으로 고차미분항일수록 $x \to 0$으로 갈때 더욱 빠르게 $0$로 수렴한다. 그 이유는 이 과정에선 설명할 수 없으니 해석학교재를 참고하길 바란다. 

- 얼마나 빠르게 $0$으로 수렴하는지 잴 수 있을까? 편의상 $m^{(1)}(0),m^{(2)}(0),\dots$ 등은 대세에 영향을 미치지 못하는 항이라고 생각하자. (실제로 그러하다. 왜냐하면 우리는 테일러 전개가 가능한 함수를 생각하므로.) 즉 얼마나 빠르게 $0$으로 수렴하는지는 오로지 미분항들의 계수 즉 
\begin{align}
(x-0),\frac{(x-0)^2}{2!},\frac{(x-0)^3}{3!},\dots
\end{align}
등에 의해서만 결정된다고 가정하자. 먼저 $x\to 0$일 경우 얼마나 빠르게 수렴하는지 체크하기 위해서 각 항을 $(x-0)$으로 나누어보자.
\begin{align}
1,\frac{(x-0)}{2!},\frac{(x-0)^2}{3!},\dots
\end{align}
1차-미분항의 계수는 $x\to 0 $ 일경우 $0$으로 수렴하지 않고 나머지항목들은 여전히 수렴한다. 왜냐하면 1차-미분항의 계수는 $(x-0)$과 똑같은 속도로 $0$으로 향해 갔기 때문이다. (***$(x-0)$으로 나누어짐 당하는 패널티를 감수하고서라도 $0$으로 수렴하려면 2차-미분항 이상처럼 $(x-0)$의 보다 더 빠른속도로 $0$으로 수렴해야한다!!***)

- 


- 
$m(0)=1$, $m^{(1)}(0)=mgf_{(X_1-\mu)/\sigma}(0)=E\big(\frac{X_1-\mu}{\sigma}\big)$ 등을 활용하면, 
\begin{align}
m(x)=1+xE\bigg(\frac{X_1-\mu}{\sigma}\bigg)+\frac{x^2}{2}E\bigg(\frac{X_1-\mu}{\sigma}\bigg)^2+R(x),\quad \frac{R(x)}{x^2} \underset{x \to 0}{\to} 0 
\end{align}
그런데 $E\big(\frac{X_1-\mu}{\sigma}\big)=0$이고 $E\big(\frac{X_1-\mu}{\sigma}\big)^2=1$이므로 
\begin{align}
m(x)=1+\frac{x^2}{2}+R(x),\quad \frac{R(x)}{x^2} \underset{x \to 0}{\to} 0 
\end{align}
$x$대신에 $t/\sqrt{n}$을 대입하면 
\begin{align}
m(t/\sqrt{n})=1+\frac{t^2}{2n}+R(t/\sqrt{n}),\quad \frac{R(t/\sqrt{n})}{(t/\sqrt{n})^2} \underset{t/\sqrt{n} \to 0}{\to} 0 
\end{align}