---
title : (정리) 확률론 (3) 
layout: post
--- 

### About this doc 

- 이 챕터에서는 WLLN 을 정리하겠다. 

### WLLN 

---

- ***(Thm 2.2.9.)*** $X_1,X_2 \dots $ 가 ***i.i.d.*** 이고 유한평균값이 존재하면 ($E\|X_i\|<\infty$) 아래가 성립한다. 
\begin{align}
S_n/n \overset{p}{\to} \mu:=EX_1.
\end{align}

---

-  확률변수가 유한평균값을 가지므로 아래가 성립한다. 
\begin{align}
(\star):\quad xP(\|X_1\|> x ) \to 0 \quad \mbox{ as } x \to \infty 
\end{align}
참고로 위의 식이 성립하는 이유는 $xP(\|X_1\|> x )\leq \leq E( \|X_1\|1_ {\|X_1\|>x} ) \to 0 $ 이기 때문이다. 왼쪽의 부등호는 적분꼴로 쓰면 바로 이해가능하고 오른쪽의 극한은 DCT에 의해서 성립한다. 아무튼 조건 $(\star)$ 가 성립하므로 이따가 다룰 ***Thm 2.2.7*** 을 쓰면 
\begin{align}
S_n / n \overset{p}{\to} \mu(n):=E(X_1 1_ {\|X_1\|\leq n}) \mbox{ as } n \to \infty 
\end{align} 
가 성립한다. 그런데 아래의 식이 성립한다. (DCT에 의해서 성립함) 
\begin{align}
\mu(n):=E(X_1 1_ {\|X_1\|\leq n}) \to \mu:=EX_1 \mbox{ as } n \to \infty 
\end{align}
이제 $S_n / n \overset{p}{\to} \mu(n)$ 와 $\mu(n)\to \mu$ 임을 이용하면 아래가 성립함을 알 수 있다. (좀더 엄밀한 풀이는 아래에서 따로 따짐)
\begin{align}
S_n/n \overset{p}{\to} \mu. 
\end{align}


- 위에서 마지막 식이 성립함을 좀더 엄밀히 따져보자. 
\begin{align}
P & (|S_n / n -\mu \| > \epsilon) \leq P(\|S_n/n -\mu(n) \|+\|\mu(n)-\mu \| > \epsilon)  \\\\ \\
\leq & P\big( \\{\|S_n/n-\mu(n)\|> \epsilon/2 \\} \cup \\{\|\mu(n)-\mu\|> \epsilon/2 \\}\big) \\\\ \\
\leq & P( \\{\|S_n/n-\mu(n)\|> \epsilon/2 \\})+P(\\{\|\mu(n)-\mu\|> \epsilon/2 \\}) \to 0 
\end{align}

- 증명과정에서 기억할만한 것은 확률변수가 유한평균값을 가진다는 것이 아래를 임플라이 한다는 것이다. 
\begin{align}
(\star):\quad xP(\|X_1\|> x ) \to 0 \quad \mbox{ as } x \to \infty 
\end{align}
반대로 위 조건(앞으로 편의상 조건 $(\star)$ 라고 부르자)이 유한평균값을 가짐을 임플라이 하지는 못한다. 따라서 조건 $(\star)$은 유한평균값을 가진다는 조건보다 약한 조건이다. 하지만 조건 $(\star)$ 은 확률변수가 유한평균값을 가진다는 조건보다 정말 말 그대로 $\epsilon$ 만큼만 약한 조건이다. 구체적으로는 조건 $(\star)$ 이 만족하면 아래를 임플라이 할 수 있다. 
\begin{align}
(\star) \quad \Longrightarrow \quad \forall \epsilon>0: ~ E\|X_1 \|^{1-\epsilon} < \infty
\end{align}
증명은 이따가 소개할 Lemma 2.2.8. 을 이용해서 할 수 있다. 따라서 조건 $(\star)$ 는 유한평균값을 가진다는 조건에 비하여 많이 부족한 조건은 아니다. 사실상 거의 대등하다고 보아도 무방하다. 

- 조건 $(\star)$ 와 ***tight*** 를 헷갈렸었다. (진짜 아는게 없어서 오만걸 다 헷갈리네) 내가 헷갈린 타이트조건은 아래와 같이 쓸 수 있다. 
\begin{align}
& \mbox{family of measures } \\{\tilde{\mu}_ i, i \in I\\} \mbox{ is } tight \\\\ \\
& \Longleftrightarrow \sup_i \tilde{\mu}_ i ([-M,M]^c) \to 0 \mbox{ as } M\to \infty
\end{align} 
즉 타잇니스(***tightness***)는 애초에 지금처럼 ***i.i.d.*** 를 가정하고 있는 상황(=고려할 분포가 1개인 상황)에서는 사용하는 개념자체가 아니다. 타잇니스는 고려한 분포가 여러개일경우 이 분포들중 가장 꼬리가 두꺼운것도 
\begin{align}
P(\|X_* \|> x ) \to 0 \quad \mbox{as } x \to \infty 
\end{align}
이 성립한다는 뜻이다. (여기에서 $X_* $ 는 가장 두꺼운 분포를 가지는 확률변수) 이 조건은 아래와 같이 쓸수도 있다. 
\begin{align}
& \mbox{sequence } \\{F_i, i \in I\\} \mbox{ is } tight \\\\ \\
& \Longleftrightarrow \forall \epsilon>0 ~ \exists ~ M_{\epsilon} \mbox{ such that } \underset{n \to \infty}{\operatorname{limsup} } 1- F_n(M_{\epsilon})+F_n(-M_{\epsilon}) \leq \epsilon.
\end{align}

- 그럼 이제 슬슬 ***Thm 2.2.7*** 로 넘어가도록 하자. 

---

- ***(Thm 2.2.7.)*** $X_1,X_2 \dots $ 가 ***i.i.d.*** 이고 $(\star): ~ xP(\|X_1\|> x ) \to 0 \mbox{ as } x \to \infty$ 라면 아래가 성립한다. 
\begin{align}
S_n/n \overset{p}{\to} \mu(n):=E(X_1 1_ {\|X_1\|\leq n}).
\end{align}

---

- ***Thm 2.2.7*** 은 확률변수 $S_n/n$ 의 $p$-수렴성은 보장하지만 그것이 $S_n/n$의 기대값 $E(S_n/n)=EX_1$ 으로 수렴함을 보장하지 않는다. 즉 
\begin{align}
S_n/n \overset{p}{\to} \mu:=E(X_1) \quad \mbox{in probability}. 
\end{align}
임을 보장하는것은 아니다. 이게 성립하려면 $\mu(n) \to \mu$ 가 성립해야 하고 이는 DCT에 의해서 성립해야하는데 DCT가 성립하려면 $E\|X_i\|<\infty$ 의 조건이 추가적으로 있어야 한다. 즉 확률변수가 유한평균값을 가지면 **WLLN** 이 성립하지만 조건 $(\star)$ 에서는 **WLLN** 이 성립함을 보장할 수 없다. 

- 참고로 아래는 그냥 성립한다. 
\begin{align}
\frac{X_1 1_ {\|X_1\| \leq n} +\dots+X_n 1_ {\|X_n\| \leq n} }{n} \overset{p}{\to} \frac{\mu_1(n)+\dots+\mu_n(n)}{n}
\end{align}
증명은 추후에 할 것이니 그냥 받아들이자. 중요한것은 ***Thm 2.2.7*** 의 조건 아래에서 
\begin{align}
\frac{X_1 1_ {\|X_1\| \leq n} +\dots+X_n 1_ {\|X_n\| \leq n} }{n},  \quad \frac{X_1+\dots+X_n}{n}
\end{align}
모두 같은 $p$-극한을 가진다는 것이다. 이것은 이전에 언급하였던 내용, 즉 ***Thm 2.2.7*** 은 확률변수 $S_n/n$ 의 $p$-수렴성은 보장하지만 그것이 $S_n/n$의 기대값 $E(S_n/n)=EX_1$ 으로 수렴함을 보장하지 않는다는 것을 다시 한번 명확하게 보여준다. 

- ***Thm 2.2.7*** 을 증명하기 위해서는 ***Thm 2.2.6*** 을 사용해야 한다. ***Thm 2.2.6*** 은 ***Thm 2.2.7*** 에 비하여 (1) $X_1,\dots,X_n$ 이 동일한 분포를 따르지 않더라도 성립하며 (2) 삼각수열의 형태로도 확장할 수 있다는 장점이 있는 정리이다.  

- ***Thm 2.2.6*** 의 장점을 좀 더 풀어서 설명하자. **(1)** $X_1,\dots,X_n$ 이 독립이지만 같은 분포를 따르지는 않는 경우에도 아래와 같은 **WLLN** 이 성립함을 보일 수 있다. 
\begin{align}
\frac{X_1+\dots+X_n}{n} \overset{p}{\to} \frac{\mu_1(n)+\dots \mu_n(n)}{n}.
\end{align}
여기에서 $\mu_i(n):=E \big(X_i 1_ { \|X_i\| \leq n}\big)$ 을 의미한다. <br/>

- **(2)** 아래와 같이 가중평균의 경우에도 **WLLN** 이 성립함을 보일 수 있다. 
\begin{align}
\frac{w_{n,1}X_1+\dots+w_{n,n}X_n}{\sum_{k=1}^n w_{n,k} } \overset{p}{\to} \frac{\mu_{n,1}(\sum_{k=1}^n w_{n,k})+\dots + \mu_{n,n} (\sum_{k=1}^n w_{n,k})}{\sum_{i=1}^n w_{n,k} }.
\end{align}
여기에서 $\mu_{n,k}:=E \big( w_ {n,k} X_k 1_ {\|w_{n,k}X_k\| \leq \sum_{k=1}^n w_{n,k} }\big)$ 이다. 우리가 흔히 아는 **WLLN** 의 경우 $w_{n,1},\dots,w_{n,n}=1$ 인 경우이다. 위의식을 더 일반적으로 쓰면  ***triangular arrays*** 형태의 수열에 대한 일반적인 **WLLN** 은 아래와 같이 쓸 수 있다. 
\begin{align}
\frac{X_{n,1}+\dots+X_{n,n} }{b_n} \overset{p}{\to} \frac{\mu_{n,1}(b_n)+\dots \mu_{n,n}(b_n)}{b_n}.
\end{align}
여기에서 $\mu_{n,k}(b_n):=E\big(X_{n,k}1_ {\|X_{n,k}\|\leq b_n } \big)$ 이다. 

---

- ***(Thm 2.2.6.)*** $X_{n,1}, \dots, X_{n,k}$가 서로 독립이지만 동일한 분포를 따르지는 않는 확률변수라고 하자. 그리고 아래의 조건들이 성립한다고 하자. <br/>
**($\tilde\star$)** $\sum_{k=1}^{n} \int_{\|X_{n,k}\|>b_n} dP_k = o(1)$ <br/>
**($\star\star$)** $\sum_{k=1}^{n} \int_{\|X_{n,k}\| \leq b_n} \frac{X_{n,k}^2}{b_n^2}dP_k = o(1)$ <br/>
이때 $b_n$ 은 양수이고 무한대로 발산하는 수열이다. 아래가 성립한다. 
\begin{align}
\frac{X_{n,1}+\dots+X_{n,n} }{b_n} \overset{p}{\to} \frac{\mu_{n,1}(b_n)+\dots+\mu_{n,n}(b_n)}{b_n}
\end{align}
여기에서 $\mu_{n,k}(b_n):=E\big(X_{n,k}1_ {\|X_{n,k}\|\leq b_n } \big)$ 이다. 

---

- 위의 조건 **($\tilde\star$), ($\star\star$)** 는 Chung의 교재스타일로 정리한것이다. Durret의 노테이션은 아래와 같다. <br/>
**($\tilde\star$)** $\sum_{k=1}^{n} P\big(\|X_{n,k}\|>b_n\big) \to 0 $ <br/>
**($\star\star$)** $b_n^{-2}\sum_{k=1}^{n} E \big( X_ {n,k}^2 1_ {\|X_{n,k}\| \leq b_n} \big) \to 0$ <br/>
위에서 엄밀하게 말하면 동일한 $P$로 쓸수 없고 $P_k$로 써야하기 때문이다. $E$역시 마찬가지이다. 하지만 간결함을 위해서 듀렛책은 이렇게 표현한것 같다. 대부분 듀렛의 노테이션을 따랐지만 ***Thm 2.2.6*** 에서만은 Chung의 기호를 빌려왔는데 그 이유는 듀렛책의 표현이 너무 간결하여 의미가 헷갈릴수도 있겠다 싶었기 때문이다. 

- 아래는 그냥 성립한다. 
\begin{align}
\frac{X_{n,1} 1_ {\|X_{n,1}\| \leq b_n}+\dots+X_{n,n} 1_ {\|X_{n,n}\| \leq b_n} }{b_n} \overset{p}{\to} \frac{\mu_{n,1}(b_n)+\dots+\mu_{n,n}(b_n)}{b_n}
\end{align}
왜냐하면 $X_{n,1} 1_ {\|X_{n,1}\| \leq b_n}$ 를 하나의 랜덤변수 $Y_{n,1}$으로 보면 $\mu_{n,1}(b_n)$ 는 $Y_{n,1}$의 평균이고, 조건 **($\star\star$)** 는 $var(S_n)/b_n^2 = o(1)$ 이 되어서 ***Thm 2.2.4*** 에 의해 **WLLN** 이 성립한다. 여기에서 
\begin{align}
S_n:=Y_{n,1}+\dots+Y_{n,n}
\end{align}
으로 정의한다. 참고로 이게 성립하기 때문에 ***Thm 2.2.7*** 의 경우에서도 
\begin{align}
\frac{X_1 1_ {\|X_1\| \leq n} +\dots+X_n 1_ {\|X_n\| \leq n} }{n} \overset{p}{\to} \frac{\mu_1(n)+\dots+\mu_n(n)}{n}
\end{align}
이 성립함을 주장할 수 있다. 

- ***Thm 2.2.6*** 의 증명은 생략하자. (교재를 참고할것) 대신에 ***Thm 2.2.6*** 의 결과를 이용하여 ***Thm 2.2.7*** 을 증명하여 보자. 

***Thm 2.2.7 의 증명*** 

- 이제 다시 ***Thm 2.2.7*** 을 증명하는 문제로 돌아오자. 증명은 ***Thm 2.2.7*** 의 상황에서 **($\tilde\star$)** 와 **($\star\star$)** 가 성립함을 보이고 ***Thm 2.2.6*** 을 적용하면 끝난다. 

- **($\star$)** 에서 ***i.i.d*** 조건을 주면 바로 **($\tilde\star$)** 를 얻어낼 수 있다. 

- 그리고 ***i.i.d*** 조건과 더불어 적절한 $b_n$의 선택이 이루어지면 **($\star$)** 은 **($\star\star$)** 를 임플라이한다. 좀 더 자세히 살펴보자. **($\star$)** 에 ***Lemma 2.2.8*** 을 사용하면 아래와 같은 식을 얻을 수 있다. (듀렛교재참고) 
\begin{align}
b_n^{-2} \sum_{k=1}^{n}
E  X_{n,k}^2 1_ { \|X_ {n,k}\| \leq b_n } 
\leq \int_{0}^{n/b_n} 2b_ n^2\tau / n P\big( \|X_ {n,1}\| \leq b_ n^2\tau / n \big) d\tau
\end{align}
위의 계산이 까다롭긴해도 못따라갈 정도는 아니다. 조건 **($\star$)** 을 쓰면 $b_n^2/n \to \infty$ 일때 
\begin{align}
b_ n^2\tau / n P\big( \|X_ {n,1}\| \leq b_ n^2\tau / n \big) \to 0
\end{align}
임을 보장할 수 있다. 그리고 이 경우 $b_ n^2\tau / n P\big( \|X_ {n,1}\| \leq b_ n^2\tau / n \big)$ 는 bounded 라고 주장할 수 있다. 왜냐하면 아래가 성립하기 때문이다. 
\begin{align}
\begin{cases}
b_ n^2\tau / n P\big( \|X_ {n,1}\| \leq b_ n^2\tau / n \big) \to 0 \\\\ \\
b_ n^2\tau / n P\big( \|X_ {n,1}\| \leq b_ n^2\tau / n \big) \leq b_ n^2\tau / n 
\end{cases}
\end{align}
따라서 아래와 같이 BCT를 쓸 수 있다. 
\begin{align}
\lim_{n\to\infty}\int_{0}^{n/b_n} 2b_ n^2\tau / n P\big( \|X_ {n,1}\| \leq b_ n^2\tau / n \big) d\tau = 
\int_{0}^{n/b_n} \lim_{n\to\infty} 2b_ n^2\tau / n P\big( \|X_ {n,1}\| \leq b_ n^2\tau / n \big) d\tau 
\end{align}
이때 $b_n=n$ 이라고 하면 $b_n^2/n \to \infty$ 이 유지되고 (따라서 피적분함수의 극한이 여전히 $0$ 이 됨) 적분의 범위가 $\int_0^1$ 과 같이 바뀌므로 아래의 식이 성립하게 된다. 
\begin{align}
\int_{0}^{1} \lim_{n\to\infty} 2n\tau P\big( \|X_ {n,1}\| \leq n \tau \big) d\tau =0
\end{align}
따라서 조건 $(\star\star)$ 가 성립한다. 

- ***(Lemma 2.2.8.)*** 양수인 확률변수 $Y$에 한정하여 아래가 성립한다. 
\begin{align}
EY^k=\int_{0}^{\infty} ky^{k-1} P(y < Y) dy
\end{align}
여기에서 $k>0$ 인 임의의 실수이다. 

- ***Lemma 2.2.8*** 은 ***Thm 2.2.7*** 을 증명하기 위해서 등장한 식인데 생각보다 여기저기에서 많이 쓰인다. 상당히 유용하다. 정리에서 $Y$를 양의 확률변수로 한정한 이유는 증명과정에서 푸비니정리를 쓰기 위함이다. 

- 이제 마지막으로 ***Thm 2.2.4*** 와 ***Thm 2.2.3*** 을 다루어보자. 

--- 

- ***(Thm 2.2.4.)*** $\frac{var(S_n)}{b_n} \to 0$ 이면 아래가 성립한다. 
\begin{align}
\frac{S_n}{b_n} \overset{p}{\to} \frac{ES_n}{b_n}
\end{align}
단 여기에서 $S_n=X_{n,1}+\dots+X_{n,n}$ 이다. 

---

- 놀라운 점은 $X_{n,1},\dots,X_{n,n}$ 에 대한 어떠한 가정도 필요없다는 것이다. 머 독립이니 무상관이니 같은분포를 따라야하니 등등의 가정이 아무필요도 없다. 

- 이 정리에 대한 증명은 ***Lemma 2.2.2*** 를 이용한다. 

- ***(Lemma 2.2.2.)*** $p>0$ 이고 $E\|Z_n\|^p \to 0 $ 이면 $Z_n \overset{p}{\to} 0$ 이 성립한다. 

- 즉 적당한 양수 $p>0$ 에 대하여 
\begin{align}
E\bigg| \frac{S_n-ES_n}{b_n}\bigg|^p \to 0 
\end{align}
임을 보이면 된다는 의미이다. ***Thm 2.2.6***,  ***Thm 2.2.7***, ***Thm 2.2.9*** 는 이것이 성립하지 않지만 ***Thm 2.2.4***  는 성립한다. 
\begin{align}
E\bigg| \frac{S_n-ES_n}{b_n}\bigg|^2 = \frac{1}{b_n^2}E(S_n-ES_n)^2=\frac{1}{b_n^2}var(S_n) \to 0.
\end{align}

- ***Thm 2.2.4.*** 는 바로 아래를 임플라이 한다. 

--- 

- ***(Thm 2.2.3.)*** $X_1,X_2,\dots $ 이 ***uncorrelated random variables*** 이고 모두 평균은 $\mu$ 이지만 같은분포를 따르지는 않는다고 하자(즉 $X_1,X_2,\dots$ 의 분산은 다를수도 있음). 그리고 $X_1,X_2,\dots $ 분산이 모두 유한한 값 $C$로 바운드된다고 가정하자. 즉 모든 $i$ 에 대하여 $var(X_i) \leq C < \infty$ 이다. 그러면 아래가 성립한다. 
\begin{align}
\frac{S_n}{n} \overset{p}{\to} \mu
\end{align}

---

