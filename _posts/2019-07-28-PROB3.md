---
title : (정리) 확률론 (3) 
layout: post
--- 

### About this doc 

- 이 챕터에서는 WLLN 을 정리하겠다. 아마 듀렛책 챕터 2.2.2 Triangular Arrays 를 위주로 정리할것 같다. 

### WLLN 

- ***(Thm 2.2.9)*** $X_1,X_2 \dots $ 가 ***i.i.d.*** 이고 유한평균값이 존재하면 ($E\|X_i\|<\infty$) 아래가 성립한다. 
\begin{align}
S_n/n \to \mu:=EX_1 \quad \mbox{in probability} .
\end{align}

- 증명을 하기 위해서는 아래가 성립함을 이해해야 한다. 
\begin{align}
xP(\|X_1\|> x ) \leq E(\|X_1\|1_ {\|X_1\|>x}) \to 0 \mbox{ as } x \to \infty 
\end{align}
왼쪽의 부등호가 성립하는건 당연하다(좌우변을 각각 적분형으로 쓰고 $\|X_1\|>x$ 를 이용하면 바로 증명가능). 오른쪽의 극한은 DCT에 의해서 성립한다. 따라서 이따가 다룰 ***Thm 2.2.7*** 을 쓰면 
\begin{align}
S_n / n \to \mu(n):=E(X_1 1_ {\|X_1\|\leq n}) \mbox{ as } n \to \infty \quad \mbox{ in probability} 
\end{align} 
가 성립한다. 그런데 아래의 식이 성립한다. (요것도 DCT에 의해서 성립함) 
\begin{align}
\mu(n):=E(X_1 1_ {\|X_1\|\leq n}) \to \mu:=EX_1 \mbox{ as } n \to \infty 
\end{align}
따라서 결국
\begin{align}
S_n/n \to \mu \quad \mbox{in probability} 
\end{align}
이 성립한다(마지막 식이 성립함은 아래에서 따로 빼서 좀 더 엄밀하게 따져보았다. 나이스한 풀이인지는 모르겠다.)

- 위에서 마지막 식이 성립함을 따져보자. 
\begin{align}
P & (|S_n / n -\mu \| > \epsilon) \leq P(\|S_n/n -\mu(n) \|+\|\mu(n)-\mu \| > \epsilon)  \\\\ \\
\leq & P\big( \\{\|S_n/n-\mu(n)\|> \epsilon/2 \\} \cup \\{\|\mu(n)-\mu\|> \epsilon/2 \\}\big) \\\\ \\
\leq & P( \\{\|S_n/n-\mu(n)\|> \epsilon/2 \\})+P(\\{\|\mu(n)-\mu\|> \epsilon/2 \\}) \to 0 
\end{align}

- 여기에서 중요한것은 확률변수가 유한평균값을 가진다는 것은 아래를 임플라이 한다는 것이다. 
\begin{align}
(\star):\quad xP(\|X_1\|> x ) \to 0 \quad \mbox{ as } x \to \infty 
\end{align}
반대로 위 조건(앞으로 편의상 조건 $(\star)$ 라고 부르자)이 유한평균값을 가짐을 임플라이 하지는 못한다. 따라서 조건 $(\star)$은 유한평균값을 가진다는 조건보다 약한 조건이다. 하지만 조건 $(\star)$ 은 확률변수가 유한평균값을 가진다는 조건보다 정말 말 그대로 $\epsilon$ 만큼만 약한 조건이다. 구체적으로는 조건 $(\star)$ 이 만족하면 아래를 임플라이 할 수 있다. 
\begin{align}
(\star) \quad \Longrightarrow \quad \forall \epsilon>0: ~ E\|X_1 \|^{1-\epsilon} < \infty
\end{align}
증명은 이따가 소개할 Lemma 2.2.8. 을 이용해서 할 수 있다. 따라서 조건 $(\star)$ 는 유한평균값을 가진다는 조건에 비하여 많이 부족한 조건은 아니다. 사실상 거의 대등하다고 보아도 무방하다. 

- 조건 $(\star)$ 와 ***tight*** 를 헷갈렸었다. (진짜 아는게 없어서 오만걸 다 헷갈리네) 내가 헷갈린 타이트조건은 아래와 같이 쓸 수 있다. 
\begin{align}
& \mbox{family of measures } \\{\tilde{\mu}_ i, i \in I\\} \mbox{ is } tight \\\\ \\
& \Longleftrightarrow \sup_i \tilde{\mu}_ i ([-M,M]^c) \to 0 \mbox{ as } M\to \infty
\end{align} 
즉 타잇니스(***tightness***)는 애초에 지금처럼 ***i.i.d.*** 를 가정하고 있는 상황(=고려할 분포가 1개인 상황)에서는 사용하는 개념자체가 아니다. 타잇니스는 고려한 분포가 여러개일경우 이 분포들중 가장 꼬리가 두꺼운것도 
\begin{align}
P(\|X_* \|> x ) \to 0 \quad \mbox{as } x \to \infty 
\end{align}
이 성립한다는 뜻이다. (여기에서 $X_* $ 는 가장 두꺼운 분포를 가지는 확률변수) 이 조건은 아래와 같이 쓸수도 있다. 
\begin{align}
& \mbox{sequence } \\{F_i, i \in I\\} \mbox{ is } tight \\\\ \\
& \Longleftrightarrow \forall \epsilon>0 ~ \exists ~ M_{\epsilon} \mbox{ such that } \underset{n \to \infty}{\operatorname{limsup} } 1- F_n(M_{\epsilon})+F_n(-M_{\epsilon}) \leq \epsilon.
\end{align}

- ***(Thm 2.2.7)*** $X_1,X_2 \dots $ 가 ***i.i.d.*** 이고 $(\star): ~ xP(\|X_1\|> x ) \to 0 \mbox{ as } x \to \infty$ 라면 아래가 성립한다. 
\begin{align}
S_n/n \to \mu(n):=E(X_1 1_ {\|X_1\|\leq n}) \quad \mbox{in probability}. 
\end{align}

- ***Thm 2.2.7*** 의 결과가 반드시 아래를 임플라이 하지는 않는다는 것을 기억하자. 
\begin{align}
S_n/n \to \mu:=E(X_1) \quad \mbox{in probability}. 
\end{align}
이게 성립하려면 $\mu(n) \to \mu$ 가 성립해야 하고 이는 DCT에 의해서 성립해야하는데 DCT가 성립하려면 $E\|X_i\|<\infty$ 의 조건이 추가적으로 있어야 한다. 즉 확률변수가 유한평균값을 가지면 **WLLN** 이 성립하지만 조건 $(\star)$ 에서는 **WLLN** 이 성립함을 보장할 수 없다. 

- 다만 조건 $(\star)$ 가 $E\|X_1\|^{1-\epsilon}<\infty$ 를 보장한다는 것을 떠올리면 아래와 같은 논리를 만들 수 있다. <br/>
**(1)** 편의상 $X_1,\dots,X_n$ 을 양수라고 가정하자. <br/>
**(2)** $X_1,\dots,X_n$ 은 유한평균값을 가지지 못한다. 즉 $E X_1 =\infty$ 라고 하자. <br/>
**(3)** 하지만 매우 작은 $\epsilon>0$ 에 대하여 $X_1^{1-\epsilon}, \dots, X_n^{1-\epsilon}$ 은 유한평균값을 가진다. <br/>
**(4)** 따라서 아래와 같은 변환을 수행하면 **WLLN** 을 쓸 수 있다. 
\begin{align}
(X_1,\dots,X_n) \to (X_1^{1-\epsilon},\dots,X_n^{1-\epsilon})
\end{align}
**(5)** (4)의 변환을 거친뒤 **WLLN** 을 쓴다면 수렴하는 값은 $E X_1^{1-\epsilon}$ 이다. 이 값은 유한하지만 매우 큰 값이다. <br>
**(6)** (4)의 변환을 수행하지 않고 **WLLN** 을 쓴다면 수렴하는 값은 $\mu(n):=E(X_1 1_{|X_1\|\leq n})=n$ 이다. 이 값은 초반에는 매우 작은 유한값을 가지지만 $n$ 이 커질수록 점점 무한대로 발산하는 값이다. 

- 이때 $\mu(n)\leq n$ 을 항상 만족하는 성질이 있음을 관찰하자. 따라서 ***Thm 2.2.7*** 이 의미하는 것은 평균이 유한한 경우 WLLN이 성립하고 평균이 무한인 경우는 $n$으로 평균을 추정한다는 의미라고 해석할 수 있다. 즉 ***Thm 2.2.7*** 은 평균이 유한하지 않을때도 어느정도 합리적인 결과를 주는 버전의 **WLLN** 이라고 볼 수 있다. 

- ***(Lemma 2.2.8.)*** 양수인 확률변수 $Y$에 한정하여 아래가 성립한다. 
\begin{align}
EY^k=\int_{0}^{\infty} ky^{k-1} P(y < Y) dy
\end{align}
여기에서 $k>0$ 인 임의의 실수이다. 

- ***Lemma 2.2.8.*** 은 ***Thm 2.2.7*** 을 증명하기 위해서 등장한 식인데 생각보다 여기저기에서 많이 쓰인다. 상당히 유용하다. 정리에서 $Y$를 양의 확률변수로 한정한 이유는 증명과정에서 푸비니정리를 쓰기 위함이다. (결국 푸비니 정리가 잘 성립되면 굳이 양수인 확률변수로 한정하지 않아도 괜찮지 않을까?) 

- ***Thm 2.2.7*** 을 증명하기 위해서는 ***Lemma 2.2.8.*** 과 함께 ***Thm 2.2.6*** 을 증명해야 한다. ***Thm 2.2.6*** 은 ***Thm 2.2.7*** 의 장점($EX=\infty$인 경우에서도 **WLLN** 적용가능함)은 기본이고 아래의 장점까지 추가로 있는 정리이다. <br/>
**(1)** $X_1,\dots,X_n$ 이 독립이지만 같은 분포를 따르지는 않는 경우에도 아래와 같은 **WLLN** 이 성립함을 보일 수 있다. 
\begin{align}
\frac{X_1+\dots+X_n}{n} \to \frac{\mu_1(n)+\dots \mu_n(n)}{n}
\end{align}
여기에서 $\mu_i(n):=EX_i 1_{\|X_i\|\leq n}$ 을 의미한다. 
**(2)** 가중평균의 경우에도 **WLLN** 이 성립함을 보일 수 있다. 
\begin{align}
\frac{w_1X_1+\dots+w_nX_n}{\sum_{i=1}^n w_i} \to \frac{w_1 \mu_1(n)+\dots + w_n\mu_n(n)}{\sum_{i=1}^n w_i}
\end{align}
일반적인 **WLLN** 의 경우 $w_1,\dots,w_n=1$ 인 경우이다. 
**(3)** 더 일반적인 경우를 생각해서 아래와 같은 경우에도 **WLLN** 이 성립함을 보일 수 있다.
\begin{align}
\frac{f_{n,1}(X_1)+\dots+f_{n,n}(X_n)}{b_n} \to \frac{f_{n,1}(\mu_1(n))+\dots f_{n,n}(\mu_n(n))}{b_n}
\end{align}

- ***Lemma 2.2.8.*** 와 조건 $(\star)$ 을 결합하면 사기적인 퍼포먼스가 나온다. 
\begin{align}
(\star): ~ xP(\|X_1\|> x ) \to 0 \mbox{ as } x \to \infty 
\end{align}
위의 조건을 

- 이제 트런케이션(***truncation***)에 대하여 알아보자. 먼저 아래와 같은 기호를 정의하자. 
\begin{align}
\tilde{X}(M) := 
\end{align}
