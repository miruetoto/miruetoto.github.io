---
layout: post
title: (정리) PID
---

### About this doc 
- 이 문서는 PID에 대한 개념을 잡기 위한 문서이다. 

- 이 문서는 아래 책을 요약한 것이다. 2019.4.10일 기준 6096회의 인용횟수를 자랑한다. <br/>
Åström, K. J., \& Hägglund, T. (1995). PID controllers: theory, design, and tuning (Vol. 2). Research Triangle Park, NC: Instrument society of America.

### Process Model 

- **PV**(process variable)을 $y(t)$라고 하고 **SP**(set point)를 $y_{sp}(t)$라고 하자. 둘 사이의 차이를 **컨트롤에러**라고 정의하고 기호로는 $e(t)$라고 하자.
\begin{align}
e(t)=y_{sp}(t)-y(t)
\end{align}

- 우리는 여기에서 2개의 장치(?)를 고려할 것이다. (1) 하나는 **컨르롤러**이고 (2) 다른 하나는 **프로세스**이다. 컨트롤러는 컨트롤에러 $e(t)$를 입력으로 받아서 컨트롤아웃풋 $u(t)$를 출력하는 어떠한 장치이다. 우리 입장에서는 함수라고 생각하면 된다. 여기에서 컨트롤 아웃풋 $u(t)$는 우리가 조작할 수 있는 어떠한 변수를 의미한다. 예를들면 벨브의 세기라든가, 팬의세기와 같은것들이 $u(t)$로 측정된다.  프로세스는 컨트롤아웃풋 $u(t)$를 입력으로 받아서 **일정시간 뒤에** $y(t+1)$을 출력한다. 이건 자연현상이다. 즉 밸브를 얼만큼 열었을때($u(t)$가 정해졌을때) 온도변화가 얼만큼 일어나게 된다는 사실을 알려주는 장치가 프로세스이다.  

- 프로세스의 출력에는 오차가 있다고 한다. 이것은 자연현상에 따른 오차일수도있고 (즉 입력을 똑같이 줘도 출력이 달라지는 경우) 관측에 따른 오차일수도 있다. (실제로 자연은 $y(t+1)$를 출력으로 줬는데 우리는 $\tilde y(t+1)$를 관측한 경우) 아무튼 자연현상에는 변덕이 심해서 $u(t)$를 알고 있어도 $y(t+1)$가 얼마가 나올지 우리는 알 수가 없다. 이러한 프로세스를 모델링 하는것은 시계열분석을 활용할수도 있고 스펙트럴 어날리시스를 활용할 수도 있다. (사실 그게 그거임) 일반적으로 스펙트럴 어날리시스는 정상시계열이 아닌 경우 분석하기 힘들지만 자연현상은 대부분 정상시계열이기 때문에 스펙트럴 어날리시스로 모델링해도 **충분**할것 같긴하다. 

- 프로세스는 그 특성에 따라서 다시 2가지로 나누어지는데 하나는 **스태틱-프로세스(static process)**이고 다른 하나는 **다이나믹-프로세스(dynamic process)** 이다. 스태틱-프로세스는 컨트롤아웃풋 $u(t)$가 주어질때 프로세스-베리어블 $y(t)$가 선형으로 나오는 경우를 의미하는것 같다. 예컨데 $u(t)$와 $y(t)$간에 아래와 같은 관계식이 성립한다면 스태틱-프로세스이다.
\begin{align}
y(t)=0.5 u(t) 
\end{align}
스태틱-프로세스의 특징은 프로세스 출력 $y(t)$는 오직 현재시점 $t$의 프로세스 입력 $u(t)$에만 의존한다는 것이다. 위의식을 이산형으로 표현하면 아래와 같이 된다. 
\begin{align}
y[t]=0.5 u[t]
\end{align}
진짜 이 경우는 너무 깔끔하게 $y[t]$를 구할 수 있다. 반면에 다이나믹-프로세스는 프로세스 출력 $y(t)$가 현재시점 $t$에 의존하지 않는모델을 의미한다. 구글링을 좀 해보면 다이나믹-프로세스는 (1) 프로세스 출력 $y(t)$와 $u(t)$사이의 관계식에 아래와 같이 미분텀이 포함된 경우 
\begin{align}
y(t)=0.5 u(t) + 0.2 \frac{d}{dt}u(t)
\end{align}
라고 설명하기도 하고 (2) 프로세스 출력 $y(t)$가 현재시점의 $u(t)$값 뿐만 아니라 과거시점의 $u(t-1)$값까지 이용하는 프로세스라고 설명하기도 한다. 잘 생각해보면 두 설명은 같은소리를 하고 있는데, 그 이유는 위의 식의 이산자료의 표현은 아래와 같고 
\begin{align}
y[t]=0.5 u[t] + 0.2 \left( u[t]-u[t-1] \right) 
\end{align}
이는 결국 아래처럼 쓸 수 있는데 
\begin{align}
y[t]=0.7 u[t] - 0.2 u[t-1] 
\end{align}
이는 결국 (2)를 의미하기 때문이다. 

- 내가 이해하기로 이 책의 범위에서 다이나믹-프로세스는 **LTI시스템**으로 이해해도 무방하다. 챕터 2.3에 보면 다이나믹-프로세스의 행동특징을 포착하는것은 매우 어려운 일이라고 설명하면서 우리는 이 책에서 LTI시스템에 한정하여 다이내믹 프로세스를 이해하겠다고 밝힌다. 우리가 관심 있어하는 프로세스가 그냥 단순히 LTI시스템일 뿐이라고 한다면 문제는 매우 단순해 진다. 왜냐하면 LTI시스템은 결국 AR류의 모델이기 때문이다. LTI시스템을 쉽게 설명하면 (1) 리니어(linear)하며 (2) 타임-인배리언트(time-invariant)한 성질을 가진 시스템을 의미한다. 이중에서 (1)은 그냥 선형시스템이라는 의미이고 (2)는 정상성(stationary)을 만족한다는 의미이다. 결국 이 모델은 일반적인 AR류에서 벗어나지 못한다고 볼 수 있다. 

- 실제 현상을 모델링하는데 이러한 AR류의 모델로 충분한지 그렇지 않은지 모르겠다. 하지만 우선 PID 컨트롤은 AR류의 모델을 기본으로 하여 이론이 정리되어 있다는 점에서 큰 한계점을 가진다. AR류의 모델은 프로세스가 정상성을 가지는 경우에는 완벽하게 동작하지만 실제현상이 반드시 정상성을 보장하지는 않는다. 단순하게 생각하여 모델에 계절성이 있는경우만 해도 정상성가정을 만족하지 못한다. 또한 분산이 시간에 따라 조금씩 변화하는 Garch와 같은 모델도 비정상시계열의 대표적 사례이다. 게다가 외부효과가 있는 경우는 (갑자기 어떠한 이벤트로 인하여 시계열 전체가 흔들리게 되는 경우) 이러한 정상성가정이 깨지게 되어서 모델링이 불가능하게 된다. 

- 아무튼 이러한 경우를 모두 없다고 생각하고 프로세스에 대한 모델링을 하겠다. 이 책에서는 다이나믹-프로세스를 LTI에 한정하였으므로 우리도 이러한 방식을 따라간다. LTI시스템은 결국 아래와 같은 모양으로 표현되는 식을 의미한다. 
\begin{align}
\sum_{l=0}^{L_1}a_ly[n-l]=\sum_{l=0}^{L_2}b_lu[n-l]
\end{align}
그리고 $a_0=1,a_1=0,a_2=0,\dots,a_{L_1}=0$과 같은 경우에는 이 시스템을 **FIR필터**라고 부르며 그 외에는 **IIR필터**라고 부른다. 

- 기본적으로 LTI시스템은 임펄스응답(impulse response)에 의하여 **유일하게(uniquely)** 결정된다. 여기에서 임펄스응답은 입력으로 임펄스입력 $\delta(t)$를 넣었을 경우 즉 $u(t)=\delta(t)$일 경우 시스템의 출력 $y(t)$를 의미하며 기호로는 $h(t)$와 같이 사용한다. 우리가 관심이 있는 시스템이 아래와 같다고 하자. 
\begin{align}
y[n]=0.5 y[n-1] + 2 x[n] + 0.5 x[n-1]
\end{align}
위의 시스템에 대한 임펄스응답 $h[n]$은 아래의 식을 만족한다. 
\begin{align}
h[n]=0.5 h[n-1] + 2 \delta[n] + 0.5 \delta[n-1]
\end{align}
위의 수식에 **z-transform**을 취하면 아래와 같다. 
\begin{align}
H(z)=0.5 z H(z) + 2 + 0.5z
\end{align}
따라서 이 경우 
\begin{align}
H(z)=\frac{2+0.5z}{1-0.5z}
\end{align}
와 같이 된다. 


- 일반적으로 물체는 외부로부터 갑작스런 자극을 받으면 물체는 초기에 매우 요동이 심한 불안정한 응답을 나타내는데 이를 트랜션트-리스펀스라고 한다. 임의의 입력 $u(t)$를 넣었을 경우 출력 $y(t)$를 뱉어내는 구조를 **시스템** 이라고 하자. 입력 $\delta(t)$에 대한 출력을 $h(t)$라고 하고 이것을 임펄스응답이라고 정의하자. 그러면 임의의 임력 $x(t)$에 대한 출력 출력 $y(t)$의 관계식은 항상 아래와 같이 쓸 수 있다. 
\begin{align}
y(t)=h(t)\ast u(t)
\end{align} 
여기에서 $h(t)$는 임펄스응답이다. 

