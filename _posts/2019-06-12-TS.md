---
layout : post 
title : (정리) Timeseries (1)
---

### About this doc 

- 이 포스팅은 시계열모델을 다룬다. 주로 참고하는 문헌은 아래와 같다. <br/>
(1) Metcalfe, A. V., & Cowpertwait, P. S. (2009). Introductory time series with R. Springer-Verlag New York. <br/>
(2) Jonathan, D. C., & Kung-Sik, C. (2008). Time series analysis with applications in R. SpringerLink, Springer eBooks. <br/>
(3) Shumway, R. H., & Stoffer, D. S. (2017). Time series analysis and its applications: with R examples. Springer. <br/>
편의상 (1)을 노란책, (2)를 파란책, (3)을 세미나책으로 부르겠다. 현재기준으로 노란책은 28회 파란책은 34회 세미나책은 4567회 인용되었다. 기본적으로는 노란책위주로 정리하였다. (노란책이 젤 쉬움) 

### AR model
- AR 모델은 아래와 같은 형태를 가진다. 
\begin{align}
y_t=\alpha_1 y_{t-1}+\alpha_2 y_{t-2} + \dots + \alpha_p y_{t-p}+\epsilon_t 
\end{align}
여기에서 $\epsilon_t$는 보통 평균이 $0$이고 분산이 $\sigma$인 **화이트노이즈(white noise)**라고 가정한다. 또한 보통 $y_t$의 평균은 $0$이라고 생각한다. 즉 모든 $t$에 대하여 $E(y_t)=0$이다. (그리고 이 포스팅에 한정하여 별 다른 언급이 없다면 항상 위와 같은 가정을 만족한다고 생각하자) 

- **(정상성)** AR 모델의 정상성을 판단하기 위해서는 (1) 모델의 특성방정식을 찾고 (2) 단위근을 구하고 (3) 모든 단위근의 절대값이 $1$보다 큰지 조사하면 된다. **(이때 단위근은 허수일수도 있음)** 모든 단위근의 절대값이 $1$ 보다 큰 경우에만 정상모델이다. 

- **(예제1)** 아래와 같은 모델이 있다고 하자. 
\begin{align}
y_t=\frac{1}{2}y_{t-1}+\epsilon_t
\end{align}
이 모델의 특성방정식(characteristic equation)은 $1-\frac{1}{2}B=0$이므로 단위근은 $B=2$이다. (여기에서 $B$는 back-operator) 따라서 이 모델은 stationary model이다. 

- **(예제2)** 아래와 같은 모델
\begin{align}
y_t=-\frac{1}{4}y_{t-2}+\epsilon_t
\end{align}
의 특성방정식은 $1+\frac{1}{4}B^2=0$이고 이것의 근은 $B=\pm 2i$이다. 이것역시 모든 근의 절대값이 $1$보다 크니깐 정상성을 만족한다. 

- **(autocovariance/autocorrelation)** AR(1)모델을 가정하자. 즉 
\begin{align}
y_t=\alpha_1 y_{t-1} + \epsilon_t 
\end{align}
이다. 임의의 $t$에 대하여 $y_t$와 $y_{t+h}$의 **autocovariance function**은 아래와 같다. 
\begin{align}
\gamma_h = \frac{\alpha_1^h \sigma^2 }{1-\alpha_1^2}
\end{align}
요것보다 좀 더 기억하기 쉬운 형태는 **autocorrelation function**이다. 그 형태는 아래와 같다. 
\begin{align}
\rho_h = \alpha_1^h
\end{align}
증명은 그렇게 어렵지 않다. 

- ***proof.*** 증명하는 방법은 그다지 어렵지 않다. 모델 $y_t=\alpha_1 y_{t-1} + \epsilon_t$ 는 
$y_t(1-\alpha_1 B)=\epsilon_t$ 와 같이 쓸 수 있고 따라서 
\begin{align}
y_t=\frac{1}{1-\alpha_1 B} \epsilon_t = (1+\alpha_1 B + \alpha_1^2 B^2 + \alpha_1^3 B^3 + \dots)\epsilon_t 
\end{align}
가 성립한다. 따라서 아래와 같이 쓸 수 있다. 
\begin{align}
y_t=\alpha_1 y_{t-1} + \epsilon_t \quad \Longleftrightarrow  \quad y_t=\epsilon_t+ \alpha_1 \epsilon_{t-1} + \alpha_1^2 \epsilon_{t-2} + \dots
\end{align} 
참고로 이런성질을 쌍대성이라고 한다. 아무튼 어지간한 모델은 위와 같이 
\begin{align}
y_t=\sum_{k=0}^{\infty}a_k \epsilon_{t-k}
\end{align}
와 같은 형태로 바꿀 수 있는데 이런 모양으로 일단 때려맞춰놓고 covariance 나 correlation 을 계산하면 편리하다. 이 경우 
\begin{align}
\begin{cases}
y_t=\epsilon_t+ \alpha_1 \epsilon_{t-1} + \alpha_1^2 \epsilon_{t-2} + \dots \\\\ 
y_{t+h}=\epsilon_{t+h}+ \alpha_1 \epsilon_{t+h-1} + \dots + \alpha_1^h \epsilon_{t} + \alpha_1^{h+1} \epsilon_{t-1} + \dots\\ 
\end{cases}
\end{align}
와 같이 되고 따라서 
\begin{align}
cov(y_t,y_{t+h}) = \alpha_1^h V(\epsilon_t) + \alpha_1 \alpha_1^{h+1} V(\epsilon_{t-1}) +  \alpha_1^2 \alpha_1^{h+2} V(\epsilon_{t-2}) + \dots
\end{align}
이 된다. 정리하면 
\begin{align}
cov(y_t,y_{t+h}) = \gamma_h = \frac{\alpha_1^h \sigma^2 }{1-\alpha_1^2}
\end{align}
와 같이 된다. 위의 식을 활용하면 $cov(y_t,y_t)=\frac{\sigma^2 }{1-\alpha_1^2}$임을 쉽게 알 수 있고 따라서 
\begin{align}
cor(y_t,y_{t+h})= \rho_h = \alpha_1^h 
\end{align}
임도 ***매우쉽게*** 증명된다. 

- 보통 autocorrelation function을 줄여서 **ACF**라고 한다. 아무튼 중요한건 AR모델의 ACF는 점점 줄어든다는 것이다. 위에서는 AR(1)만 살펴보았지만 다른 모델도 비슷하다. 그외에 대충 아래와 같은 특징을 기억하면 된다. <br/><br/>
**(1)** AR류의 정상시계열은 ACF의 절대값이 점점 감소하는 형태를 가진다. 하지만 ACF의 절대값이 점점 감소한다고 해서 그게 반드시 AR류의 정상시계열이라는 보장은 없다. (랜덤워크의 경우 비정상시계열인데 ACF의 절대값이 점점 줄어듬) 
**(2)** 따라서 ACF 만을 보고 정상시계열인지 아닌지 판단하는것은 불가능하다. <br/>
**(3)** ACF의 부호가 항상 양수이면 모든 $\alpha_1,\dots,\alpha_p$의 값이 양수라고 볼 수 있다. <br/>
**(4)** AR류의 정상시계열이라고 할지라도, ACF그림을 보고 AR(1)인지 AR(2)인지 판단하는 것은 불가능하다. <br/>
**(5)** ACF가 특정 lag까지만 발생한다면 MA류모델이다. 예를 들어서 ACF를 찍어봤는데 $h=3$까지만 값이 있다고 치면 이건 MA(3)모델이라고 봐도 된다. (실제로는 MA모델이 거의 없으니까 이런 경우는 거의 없다.) <br/>

- 위에서 언급된 (4),(5)를 잘 생각해보면 아이러니하게 실제로 ACF는 MA모델을 판단하기에 더 유리하다는 것을 알 수 있다. 이걸 보안하기 위해서 고안한 것이 **PACF**이다. PACF는 $y_t$와 $y_{t+h}$의 correlation이 아니라 partial correlation 을 고려하는 방식이다. AR(p) 모델에서 PACF를 찍어보면 $h=7$까지만 계수값이 존재하는 장점이 있다. (매우편리함) 

- 랜덤워크인 

### 
