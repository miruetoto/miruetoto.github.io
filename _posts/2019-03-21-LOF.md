---
layout: post 
title: (리뷰) LOF
---

### About this document 
- 여기서는 아래의 논문을 요약하였다. <br/>
***REF***: Breunig, M. M., Kriegel, H. P., Ng, R. T., & Sander, J. (2000, May). LOF: identifying density-based local outliers. In ACM sigmod record (Vol. 29, No. 2, pp. 93-104). ACM.

- 위의 논문에서는 **리처빌리티-디스턴스(Reachability Distance)** 라는 개념이 나오는데 이것이 HST에서 제안하는 dissimilarity와 유사하다. 이 논문에서 제시한 anormally detection방법과 우리의 방법을 비교해보면 매우 유익할것이다. 

### Formal definition of local outliers 
- 먼저 하나의 점 $p$에 대한 $k$-distance를 정의하여 보자. 기호로는 $dist(p,k)$와 같이 쓰는데 이것은 점 $p$와 $k$번째로 가까운 점과의 거리이다. $k=1$이면 점 $p$와 자기자신의 거리를 의미한다. 따라서 특정 데이터셋 $D$에 포함된 모든 점 $p$에 대하여 $dist(p,1)=0$ 이 성립한다. 만약에 $k=2$이면 점 $p$와 (자기자신을 제외하고) 가장 가까운 점들과의 거리를 의미한다. 만약에 점 $p$와 가장 가까운 점이 3개가 동시에 존재한다면 
\begin{align}
dist(p,2)=dist(p,3)=dist(p,4)
\end{align}
와 같이 된다. 예를 들어보자. 하나의 수직선을 생각하자. $p=0$이라고 하고 $o_{-2}=-2$, $o_1=1$, $o_2=2$, $o_3=3$, $o_4=4$의 위치에 라고 하자. 인덱스에 음수가 들어가는게 거슬리지만 너그럽게 이해하자. 이 경우 
\begin{align}
dist(p,1)=0 \\\\ \\\\
dist(p,2)=1 \\\\ \\\\
dist(p,3)=dist(p,4)=2 \\\\ \\\\
dist(p,5)=3 \\\\ \\\\
dist(p,6)=4 
\end{align}
와 같이 된다. 


- $x$에서 $x^* $까지의 **리처빌리티-디스턴스(Reachability Distance)** 는 아래와 같이 정의한다. 
\begin{align}
RD({\bf x}, {\bf x^* } ,k)= \max (\\| {\bf x}- {\bf x}^{(k)} \\| ,\\| {\bf x}- {\bf x^* } \\| ) 
\end{align}
여기에서 ${\bf x}^{(k)}$는 훈련표본 $\\{ {\bf x}_ i\\}_ {i=1}^{n}$중에서 ${\bf x}$와 $k$번째로 가까운 표본을 나타낸다. 정의를 잘 보면 알겠지만 
$dist({\bf x}, {\bf x^* } ,k)$와 $dist({\bf x^* },{\bf x} ,k)$는 같지 않으므로 이것은 metric이라고 볼 수 없다. 

- 여기에서 $k$는 어떠한 역할을 할까? 일단 $k=1$이라고 생각해보자. 그러면 **리처빌리티-디스턴스** 는 유클리드 거리와 완전히 같다. 그런데 아무래도 저자들은 가까운 거리에 있는 점들간의 랭킹은 별로 의미가 없다고 생각한것 같다. 예를들어 어떠한 두 점이 $0.00001$ 만큼 떨어져있거나 $0.1$만큼 떨어져있는것 모두 가까운 거리에 있다고 생각하면 될일이지 굳이 후자가 전자에 비해서 만배 더 멀리 있다고 생각할 필요가 없다는 것이다. 이러한 아이디어를 확장하여 저자들은 **임의의 두 점 사이의 거리를 너무 작게 설정하지 않고 최소한 이정도의 거리는 보장해 주는것이 어떨까?** 라고 생각하게 되었고 그 결과 만들어 진게 **리처빌리티-디스턴스** 이다. 그리고 $k$가 조절하는것은 두 점사이의 거리의 최소값을 얼마나 보정할지를 조정하는 역할을 한다. $k$가 작을수록 보정값이 작다. 앞에서 밝혔듯이 $k=1$ 이면 보정값이 $0$이므로 **리처빌리티-디스턴스**는 유클리드거리와 같다. 만약에 $k=3$이면 $\bf x$와 가장 가까운것으로 top3 에 드는 점은 모두 $\\|{\bf x}- {\bf x}^{(3)} \\|$과 같은 거리를 가지게 된다(하향평쥰화느낌). $k$가 전체자료의 수와 동일하게 설정하면 ${\bf x}$에서 모든 자료들이 똑같은 거리만큼 떨어져 있다고 생각한다. 

- 즉 $k$는 자료들간의 distance를 얼마나 민감하게 랭킹할것인지를 결정한다는 것을 알 수 있다. **리처빌리티-디스턴스** 는 자료간의 랭킹을 아래와 같은 원칙으로 한다. <br/><br/>
*(1) 기준점 ${\bf x}$와 가까이에 있는 점들을 선정한다. 이 점들의 집합을 ${\cal N}_k({\bf x})$라고 한다. 이때 $k$의 의미는 위에서 정의한 것과 같다. 즉 ${\cal N}_({\bf x})$는 ${\bf x}$와 가장 가까운 top3 점들을 모아둔 집합이다. 아무튼 이 그룹에 선정된 점들은 모두 동일한 **리처빌리티-디스턴스**를 얻게 된다. 그 값은 선정된 값들 중에서 가장 ${\bf x}$와 멀리있는 점과 ${\bf x}$의 유클리드 거리이다. <br/>
(2) 위의 단계에서 선택받지 못한 점들은 ${\bf x}$와의 유클리드 거리를 **리처빌리티-디스턴스**로 부여받는다. <br/><br/>*
즉 $k$가 커질수록 자료들을 대충 다 비슷하게 본다는 것이고 $k$가 작을수록 자료들의 거리를 민감하게 랭킹한다는 의미가 된다. 이런 의미에서 $k$는 HST의 $\tau$와 비슷한 느낌을 준다. 저자들은 이 $k$를 Minpts라고 표현한다. 정확한 의미는 모르겠지만 **minimal number of points**의 약자인것 같다. 여기에서는 그냥 계속 $k$라고 표현하겠다. 

- 이제 **로칼-리처빌리티-덴시티(Local Reachability Density)** 에 대하여 알아보자. ${\bf x}$의 **로칼-리처빌리티-덴시티**는 아래와 같이 정의한다. 
\begin{align}
LRD({\bf x},k)=\left(\frac{1}{k} \sum_{i=1}^{k}RD({\bf x},{\bf x}^{(i)},k) \right)^{-1}
\end{align}



### Properties of local outliers 

### The impact of the parameter minpts 

