---
layout: post 
title: (정리) 선형대수학 - 기본
---

### About this post
- 이번에는 선형대수학의 기본연산들을 다룬다. 구체적으로는 행렬의 곱셉 따위를 다룬다. 이 부분이 너무 당연해 보이고 쓸모 없어보일 수도 있지만 몇 가지 기호를 정리하는 측면에서 가치가 있다. 나한테는 의외로 유용한 포스팅이다. 

- 본 포스트에서는 나만 쓰는 notation이 있다. 예를들면 $rbind(c(1,2),c(2,4))$라든가 ${\bf X}[,1]$과 같은 식의 기호이다. 이것은 R프로그래머라면 익숙한 기호이지만 그렇지 않은사람에게는 낯설 수 있다. 나는 이러한 notation이 익숙하여 내맘대로 쓰겠다.

### 매트릭스 표현법

- 이 챕터에서는 일반적인 매트릭스를 ${\bf X}$와 같이 인덱스가 없는 대문자 볼드체로 종종 표시할 것이다. 이때 매트릭스 ${\bf X}$의 차원은 통상적으로 통계학과에서 정의하는대로 $n \times p$라고 생각하자. 매트릭스 ${\bf X}$의 column은 $X_1, X_2, \dots$와 같이 인덱스가 있는 대문자로 종종 표시할 것이다. 물론 일반적인 교재에서는 일반적으로 이러한 column 벡터를 소문자 볼드체로 표현하므로 이러한 표기법은 매우 헷갈릴 수 있다. 따라서 
\begin{align}
{\bf X}=cbind(X_1, X_2, \dots, X_p)
\end{align}
와 같이 될 수 있는 한 명확하게 명시를 하겠다. 매트릭스 ${\bf X}$의 row는 ${\bf x}_ 1, {\bf x}_ 2, \dots$와 같은 방식으로 종종 표시할 것이다. 이것은 헷갈리는 표현인데 언급하였듯이 일반적인 교재에서 ${\bf x}_ 1$와 같이 소문자로 표시된 것은 일반적으로 col-vector를 의미하기 때문이다(여기서는 row-vector). 따라서 이 역시 
\begin{align}
{\bf X}=rbind({\bf x}_ 1, {\bf x}_ 2, \dots, {\bf x}_ n)
\end{align}
와 같이 될 수 있는 한 명확하게 명시를 하겠다.    

- 이인석교수의 교재에서는 매트릭스 ${\bf X}$를 아래와 같이 표현가능하다. 이 역시 매우 유용한 표현이다. 
\begin{align}
{\bf X}=\left(x_{ij}\right)
\end{align}
처음에는 이러한 표현이 매우 헷갈려서 정신병 걸릴거 같았지만 나중에는 이 표현을 안쓰는 것이 더 암걸릴것 같은 고통을 주므로 그냥 쓰기로 결정하였다. 

- 위의 내용을 종합하면 보통 통계학과에서 사용하는 디자인매트릭스 ${\bf X}_ {n \times p}$를 아래와 같이 표현가능하다. 
\begin{align}
{\bf X}=cbind(X_1,\dots,X_p)=rbind({\bf x}_ 1, \dots, {\bf x}_ n)=\left(x_{ij}\right)
\end{align}
R문법으로 해석하면 여기에서 $X_p ={\bf X}[,p]$이고, ${\bf x}_ n = {\bf X}[n,]$이고 $x_{ij}={\bf X}[i,j]$가 된다. 이때 ${\bf x}_ n$은 row-vector임을 유의하자. 

- 매트릭스 ${\bf X}$의 특정 row 혹은 column이 아닌 일반적인 row-vector 혹은 col-vector는 ${\bf a}, {\bf b}, {\bf x}$와 같이 인덱스가 없는 소문자 볼드체로 표시할 것이다. 가급적이면 row-vector인지 col-vector인지 명확하게 명시할 예정이지만 만약에 언급이 없다면 col-vector로 생각해도 된다. 일반적인 col-vector ${\bf a}_ {n \times 1}$는 아래와 같이 표현할 수 있다. 
\begin{align}
{\bf a}=c(a_1,\dots,a_n)=rbind(a_1,\dots,a_n)
\end{align}
이와 유사한 논리로 row-vector 역시 표현할 수 있다. 예를들어 임의의 디자인매트릭스 ${\bf X}_ {n \times p}$의 첫번째 row-vector ${\bf x}_ 1$은 아래와 같이 표현가능하다. 
\begin{align}
{\bf x}_ 1=cbind(x_{11},\dots,x_{1p})
\end{align}

### 트랜스포즈 

- 매트릭스 ${\bf X}$의 트랜스포즈는 보통 ${\bf X}^T$로 표시한다. 혼란의 여지가 없을 경우 노테이션의 간략화를 위하여 ${\bf X}'$와 같이 표현할 수 있다. 매트릭스 ${\bf X}$가 복소행렬일 경우는 트랜스포즈를 사용하지 않고 **컨쥬게이트-트랜스포즈**(conjugate transpose)를 사용한다. 컨쥬게이트-트랜스포즈는 **에르미트-트랜스포즈**(Hermitian transpose), **에르미트-어드조인트**(Hermitian adjoint) 등으로 불리기도 한다. 기호로는 ${\bf X}^H$로 표시한다. 

- 임의의 매트릭스 ${\bf X}_ {n \times p}$에 대하여 ${\bf X}'$는 아래와 같이 표현할 수 있다. <br/><br/>
***case 1***: ${\bf X}$가 col-vector의 결합으로 표현된 경우 <br/>
\begin{align}
\begin{cases}
{\bf X}=cbind(X_1, \dots, X_p) \\\\ 
{\bf X}'=\left[cbind(X_1, \dots, X_p)\right]^T=rbind(X_1',\dots,X_p') ,
\end{cases}
\end{align}
***case 2***: ${\bf X}$가 row-vector의 결합으로 표현된 경우<br/>
\begin{align}
\begin{cases}
{\bf X}=rbind({\bf x}_ 1, \dots, {\bf x}_ n) \\\\ 
{\bf X}'=\left[rbind({\bf x}_ 1,\dots,{\bf x}_ n)\right]^T = cbind({\bf x}_ 1', \dots, {\bf x}_ n'),
\end{cases}
\end{align}
***case 3***: ${\bf X}$가 이인석교수님 스타일로 표현된 경우 <br/>
\begin{align}
\begin{cases}
{\bf X}=\left(x_{ij}\right) \\\\ 
{\bf X}'=\left(x_{ji}\right).
\end{cases}
\end{align}

- 위와 같은 표현은 벡터에서도 가능하다. <br/><br/>
***case 1***: col-vector ${\bf a}_ {n \times 1}$에 대하여 아래와 같이 쓸 수 있다.  <br/>
\begin{align}
\begin{cases}
{\bf a}= c(a_1,\dots,a_n) \\\\ 
{\bf a}'= \left[c(a_1,\dots,a_n)\right]^T=cbind(a_1',\dots,a_n')=cbind(a_1,\dots,a_n).
\end{cases}
\end{align}
***case 2***: 매트릭스 ${\bf X}_ {n \times p}$의 첫번째 row-vector ${\bf x}_ 1$에 대하여 아래와 같이 쓸 수 있다.  <br/>
\begin{align}
\begin{cases}
{\bf x}_ 1= cbind(x_{11},\dots,x_{1p}) \\\\ 
\left({\bf x}_ 1 \right)^T = \left[cbind(x_{11},\dots,x_{1p})\right]^T=rbind(x_{11},\dots,x_{1p})=c(x_{11},\dots,x_{1p}).
\end{cases}
\end{align}

- 트랜스포즈는 보통 $L_2$-norm을 구할때 사용할 수 있다. 당연한 소리지만 col-vector일 경우와 row-vector일 경우 $L_2$-norm의 정의가 다르다. 즉 \begin{align}
\\| X_ p \\|_ 2^2=X_ p'X_ p
\end{align}
이고 
\begin{align}
\\| {\bf x}_ n \\|_ 2^2={\bf x}_ n {\bf x}_ n'
\end{align}
이다.

### 행렬곱

- 임의의 행렬 ${\bf X}_ {n \times p}$, ${\bf T}_ {p \times q}$에 대하여 행렬곱 ${\bf X}{\bf T}$은 아래와 같은 다양한 방법으로 정의할 수 있다. 
**(1)** 다음과 같이 이인석교수님 스타일의 행렬로 정의할 수 있다. 이 방법은 일반적인 행렬의 곱셉법인 "rows $\times$ cols"의 꼴로 표현한 것이다. 
\begin{align}
{\bf X}{\bf T}=\left( \sum_{k=1}^{p} x_{ik}t_{kj} \right) ,~ ~ where ~ ~  i=1,2,\dots,n ~ ~ and ~ ~ j=1,2,\dots,q. 
\end{align}
**(2)** 위의 표현방법은 아래와 같은 방식으로도 표현할수 있다. 행렬곱결과에서 $(i,j)$-th 콤포넌트를 매우 컴팩트하게 표현할 수 있는 장점이 있다. 
\begin{align}
{\bf X}{\bf T}=rbind({\bf x}_ 1,\dots {\bf x}_ n) cbind(T_1,\dots,T_q) = \left( {\bf x}_ i T_j \right), 
\end{align}
단 여기에서 $i=1,2,\dots,n$ 이고 $j=1,2,\dots,q$ 이다. <br/>
**(3)** 또한 아래와 같이 행렬곱을 "cols $\times$ rows"로 표현할 수도 있다. 이것은 행렬곱의 결과를 **행렬들의 합**꼴로 표현할 수 있는 장점이 있다. 
\begin{align}
{\bf X}{\bf T}=cbind(X_1,\dots X_p) rbind({\bf t}_ 1,\dots,{\bf t}_ p) = \sum_{k=1}^{p} X_k {\bf t}_ k.
\end{align}
**(4)** 행렬곱을 아래와 같이 "rows $\times$ matrix"의 꼴로 표현할 수도 있다. 
\begin{align}
{\bf X}{\bf T}=rbind({\bf x}_ 1,\dots {\bf x}_ n) {\bf T} = rbind({\bf x}_ 1 {\bf T} ,\dots {\bf x}_ n {\bf T} ) .
\end{align}
**(5)** 행렬곱을 아래과 같이 "matrix $\times$ cols"의 꼴로 표현할 수도 있다. 
\begin{align}
{\bf X}{\bf T}={\bf X} cbind(T_1,\dots,T_q) =  cbind({\bf X}T_1,\dots,{\bf X}T_q). 
\end{align}
식은 5개이지만 사실 (1)과 (2)는 같은 표현이므로 (2)-(5) 정도만 잘 기억하면 된다. 여담이지만 (3)과 같은 표현법은 고유치분해를 다룰때 매우 유용하다. 

- 통계학과에서는 ${\bf X}'{\bf X}$를 계산할 일이 자주 생긴다. ${\bf X}'{\bf X}$는 아래와 같이 표현할 수 있다. 이러한 표현방법들을 잘 숙지해두면 도움이 된다. <br/> 
**(1)** $rbind(X_ 1',\dots,X_ p') cbind(X_ 1,\dots,X_ p)= \left(X'_ i X_ j\right),$ for all $i,j = 1,2,\dots,p$.  <br/>
**(2)** $cbind({\bf x}_ 1',\dots, {\bf x}_ n') rbind({\bf x}_ 1,\dots, {\bf x}_ n) = \sum_{i=1}^{n} {\bf x}_ i' {\bf x}_ i$ <br/>
**(3)** $rbind(X_1',\dots,X_ p') {\bf X} = rbind(X_1'{\bf X},\dots,X_p' {\bf X})$ <br/>
**(4)** ${\bf X}' cbind(X_1,\dots,X_p)=  cbind({\bf X}'X_1,\dots,{\bf X}'X_p)$ 

- 대각행렬이 있을 경우의 곱셈법을 숙지하는것도 매우 중요하다. 대각행렬 ${\bf D}$는 
\begin{align}
{\bf D}=diag(\lambda_1,\dots,\lambda_p)
\end{align}
와 같은 기호로 표시한다. 대각행렬의 경우 임의의 행렬 ${\bf C}_ {n \times p}$와 행렬 ${\bf E}_ {p \times q}$에 대하여 아래의 식이 성립함을 기억하면 편리하다. (좀 헷갈릴 수 있는데 그냥 외우는게 속편함) <br/>
**(1)** "cols $\times$ diag" 와 같은 경우 아래와 같이 쓸 수 있다. 
\begin{align}
{\bf C}{\bf D}=cbind(C_1, \dots, C_p)diag(\lambda_1,\dots,\lambda_p)=cbind(C_1 \lambda_1 ,\dots,C_p \lambda_p )
\end{align}
**(2)** "diag $\times$ rows" 와 같은 경우 아래와 같이 쓸 수 있다. 
\begin{align}
{\bf D}{\bf E}=diag(\lambda_1,\dots,\lambda_p)rbind({\bf e}_ 1, \dots, {\bf e}_ p)=rbind(\lambda_1{\bf e}_ 1, \dots, \lambda_p{\bf e}_ p)
\end{align}
**(3)** SVD를 전개할 경우 아래와 같은 표현들이 자주 나온다. 
\begin{align}
{\bf U} {\bf D}=cbind(U_1,\dots, U_p)diag(\lambda_1,\dots,\lambda_p)=cbind(U_1 \lambda_1,\dots, U_p \lambda_p)
\end{align}
\begin{align}
{\bf D}{\bf V}'=diag(\lambda_1,\dots,\lambda_p)rbind(V_1', \dots, V_p')=rbind(\lambda_1V_ 1', \dots, \lambda_pV_ p')
\end{align}
궁극적으로는 아래의 식을 기억하면 편리하다. 
\begin{align}
{\bf U}{\bf D}{\bf V}'= \sum_{i =1}^{p} U_i \lambda_i  V_i'
\end{align}
SVD에서 가끔씩 ${\bf D}$를 정사각행렬이 아니라 사각행렬로 ${\bf D}_ {n \times m}$로 정의할때도 있다. 보통 ${\bf U}{\bf D}{\bf V}'$의 형태에서 정사각행렬 ${\bf U}$와 정사각행렬 ${\bf V}$의 차원이 달라서 이런식으로 정의한다. 일반적으로 ${\bf D}$의 차원은 ${\bf X}$의 차원과 동일하게 $n \times p$로 설정하고 ${\bf U}$는 $n \times n$ 행렬로 ${\bf V}'$는 $p \times p$ 행렬로 되는 경우가 많다. 따라서 보통 ${\bf D}_ {3\times 2}=rbind(c(\lambda_1,0),c(0,\lambda_2),c(0,0))$와 같이 세로로 긴 대각행렬을 다루는 경우가 많다. 물론 ${\bf D}_ {2 \times 3}=rbind(c(\lambda_1,0,0),c(0,\lambda_2,0))$와 같이 가로로 긴 대각행렬을 정의할 수도 있다. 아무튼 두 경우 모두 편의상 $diag(\lambda_1,\lambda_2)$로 표현가능하다. 그리고 이 경우에는 행렬곱을 $min(n,m)$까지만 전개하면된다. 예를들면 아래와 같은 식으로 말이다. 
\begin{align}
cbind(U_1,U_2,U_3{\bf D}_ {3 \times 2}=cbind(U_1,U_2,U_3)diag(\lambda_1,\lambda_2)=cbind(U_1\lambda_1,U_2\lambda_2)
\end{align}

### 트레이스 

- $tr({\bf A})=tr({\bf A}')$

- $tr({\bf A}{\bf B}{\bf C})=tr({\bf B}{\bf C}{\bf A})=tr({\bf C}{\bf A}{\bf B})$

- 임의의 col-vector $X_1$에 대하여 아래식이 성립한다. 
\begin{align}
X_1'X_1=tr(X_1X_1')
\end{align}
또한 임의의 row-vector ${\bf x}_ 1$에 대하여 아래식이 성립한다. 
\begin{align}
{\bf x}_ 1 {\bf x}_ 1'=tr({\bf x}_ 1'{\bf x}_ 1).
\end{align}
